<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rashid C.J. Marcano Rivera, Ph.D., M.S., M.A.">

<title>CACCS: Taller de RStudio - 1ª parte</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Taller1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Taller1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Taller1_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller1_files/libs/quarto-html/quarto-syntax-highlighting-9f30c2c2d2429ed22c1cf9f617479b3b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller1_files/libs/bootstrap/bootstrap-43d07d8d88cce9be8b98331561df514a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">1</span> Introducción</a></li>
  <li><a href="#sobre-aprender-r" id="toc-sobre-aprender-r" class="nav-link" data-scroll-target="#sobre-aprender-r"><span class="header-section-number">2</span> Sobre aprender R</a>
  <ul class="collapse">
  <li><a href="#usando-rstudio-y-presentando-por-encima-quarto" id="toc-usando-rstudio-y-presentando-por-encima-quarto" class="nav-link" data-scroll-target="#usando-rstudio-y-presentando-por-encima-quarto"><span class="header-section-number">2.1</span> Usando RStudio (y presentando por encima, Quarto)</a></li>
  </ul></li>
  <li><a href="#interacción-con-la-consola-de-r" id="toc-interacción-con-la-consola-de-r" class="nav-link" data-scroll-target="#interacción-con-la-consola-de-r"><span class="header-section-number">3</span> Interacción con la consola de R</a>
  <ul class="collapse">
  <li><a href="#asignando-valores-a-objetos" id="toc-asignando-valores-a-objetos" class="nav-link" data-scroll-target="#asignando-valores-a-objetos"><span class="header-section-number">3.1</span> Asignando valores a objetos</a></li>
  <li><a href="#funciones" id="toc-funciones" class="nav-link" data-scroll-target="#funciones"><span class="header-section-number">3.2</span> Funciones</a></li>
  </ul></li>
  <li><a href="#importando-datos" id="toc-importando-datos" class="nav-link" data-scroll-target="#importando-datos"><span class="header-section-number">4</span> Importando datos</a>
  <ul class="collapse">
  <li><a href="#tipos-de-datos" id="toc-tipos-de-datos" class="nav-link" data-scroll-target="#tipos-de-datos"><span class="header-section-number">4.1</span> Tipos de datos</a></li>
  <li><a href="#el-operador-de-accesso" id="toc-el-operador-de-accesso" class="nav-link" data-scroll-target="#el-operador-de-accesso"><span class="header-section-number">4.2</span> El operador de accesso <code>$</code></a>
  <ul class="collapse">
  <li><a href="#apegándonos-de-un-conjunto-de-datos" id="toc-apegándonos-de-un-conjunto-de-datos" class="nav-link" data-scroll-target="#apegándonos-de-un-conjunto-de-datos"><span class="header-section-number">4.2.1</span> Apegándonos de un conjunto de datos</a></li>
  <li><a href="#verificando-las-variables" id="toc-verificando-las-variables" class="nav-link" data-scroll-target="#verificando-las-variables"><span class="header-section-number">4.2.2</span> Verificando las variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#entendiendo-y-manipulando-datos-tidyverse" id="toc-entendiendo-y-manipulando-datos-tidyverse" class="nav-link" data-scroll-target="#entendiendo-y-manipulando-datos-tidyverse"><span class="header-section-number">5</span> Entendiendo y manipulando datos: Tidyverse</a>
  <ul class="collapse">
  <li><a href="#modificando-conjuntos-de-datos-creando-una-variable" id="toc-modificando-conjuntos-de-datos-creando-una-variable" class="nav-link" data-scroll-target="#modificando-conjuntos-de-datos-creando-una-variable"><span class="header-section-number">5.1</span> Modificando conjuntos de datos: creando una variable</a></li>
  <li><a href="#el-operador-pipe-o" id="toc-el-operador-pipe-o" class="nav-link" data-scroll-target="#el-operador-pipe-o"><span class="header-section-number">5.2</span> El operador pipe <code>%&gt;%</code> o <code>|&gt;</code></a></li>
  <li><a href="#resumiendo-datos-explorativamente-con-tidy" id="toc-resumiendo-datos-explorativamente-con-tidy" class="nav-link" data-scroll-target="#resumiendo-datos-explorativamente-con-tidy"><span class="header-section-number">5.3</span> Resumiendo datos explorativamente con Tidy</a></li>
  </ul></li>
  <li><a href="#visualización-de-datos-porqués" id="toc-visualización-de-datos-porqués" class="nav-link" data-scroll-target="#visualización-de-datos-porqués"><span class="header-section-number">6</span> Visualización de datos: porqués</a></li>
  <li><a href="#ggplot2" id="toc-ggplot2" class="nav-link" data-scroll-target="#ggplot2"><span class="header-section-number">7</span> ggplot2</a>
  <ul class="collapse">
  <li><a href="#componentes-de-un-gráfico" id="toc-componentes-de-un-gráfico" class="nav-link" data-scroll-target="#componentes-de-un-gráfico"><span class="header-section-number">7.1</span> Componentes de un gráfico</a></li>
  <li><a href="#lienzo-vacío-y-capas" id="toc-lienzo-vacío-y-capas" class="nav-link" data-scroll-target="#lienzo-vacío-y-capas"><span class="header-section-number">7.2</span> Lienzo vacío y capas</a></li>
  <li><a href="#el-gráfico-que-buscábamos" id="toc-el-gráfico-que-buscábamos" class="nav-link" data-scroll-target="#el-gráfico-que-buscábamos"><span class="header-section-number">7.3</span> El gráfico que buscábamos</a></li>
  <li><a href="#gráficos-rápidos-qplot" id="toc-gráficos-rápidos-qplot" class="nav-link" data-scroll-target="#gráficos-rápidos-qplot"><span class="header-section-number">7.4</span> Gráficos rápidos: <code>qplot()</code></a></li>
  <li><a href="#alcanzando-visualización-de-densidades-y-sus-cambios-a-través-del-tiempo" id="toc-alcanzando-visualización-de-densidades-y-sus-cambios-a-través-del-tiempo" class="nav-link" data-scroll-target="#alcanzando-visualización-de-densidades-y-sus-cambios-a-través-del-tiempo"><span class="header-section-number">7.5</span> Alcanzando visualización de densidades y sus cambios a través del tiempo</a></li>
  </ul></li>
  <li><a href="#recapitulando" id="toc-recapitulando" class="nav-link" data-scroll-target="#recapitulando"><span class="header-section-number">8</span> Recapitulando</a>
  <ul class="collapse">
  <li><a href="#qué-aprendimos-en-este-taller-inicial" id="toc-qué-aprendimos-en-este-taller-inicial" class="nav-link" data-scroll-target="#qué-aprendimos-en-este-taller-inicial"><span class="header-section-number">8.1</span> Qué aprendimos en este taller inicial</a></li>
  <li><a href="#continuamos-el-próximo-martes" id="toc-continuamos-el-próximo-martes" class="nav-link" data-scroll-target="#continuamos-el-próximo-martes"><span class="header-section-number">8.2</span> Continuamos el próximo martes</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">CACCS: Taller de RStudio - 1ª parte</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rashid C.J. Marcano Rivera, Ph.D., M.S., M.A. </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introducción" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introducción</h1>
<p><strong>Introducción a la computación estadística en R</strong></p>
<p>Este taller está basado en notas de Paul Thibodeau y revisiones de profesores del departamento de psicología de BYU <a href="https://fhssrsc.byu.edu/r-workshop">(vea esa versión aquí)</a>. Adaptado al español y usando ejemplos del libro de Rafael Irizarry <a href="https://leanpub.com/dslibro">disponible aquí</a>. Ha sido revisado de la primeras versión de este taller, brindadas en el Centro Académico de Cómputos de Ciencias Sociales en los pasados semestres.</p>
<p><em>Si aún no has instalado R, está disponible <a href="http://cran.us.r-project.org/">aquí</a>. Acto seguido, <a href="https://posit.co/download/rstudio-desktop/">baja RStudio</a>. Puedes también ir a la nube <a href="https://posit.cloud/">en Posit Cloud</a>.</em></p>
</section>
<section id="sobre-aprender-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Sobre aprender R</h1>
<p>R es un lenguaje creado por estadísticos como ambiente interactivo para análisis de datos. En R pueden guardar su trabajo como una secuencia de comandos, conocida como un <em>script</em>, que se pueden ejecutar fácilmente en cualquier momento, con portabilidad. Estos <em>scripts</em> sirven como un registro del análisis que realizaron, una característica clave que facilita el trabajo <u><strong><em>reproducible</em></strong></u>. Si bien es un programa poderoso y flexible, es ciertamente más complicado que programados como el que puedan encontrar en SPSS o STATA, donde pueden señalar con el ratón una opción y ejecutarla. Por otro lado, R es gratuito y de código abierto. En adición es modular y las funcionalidades añadidas complementariamente por terceros también son gratuitos, incluyendo acceso temprano a los métodos y herramientas más recientes que se desarrollan para una amplia variedad de disciplinas, incluyendo la economía, ciencias políticas, sociología, planificación, ecología, geografía o la biología molecular, entre otros.</p>
<p>Mi idea tras esta secuencia de talleres sobre R es brindar una introducción para que puedan interactuar con R tal que los sentimientos de frustración o ansiedad que puedan surgir al trabajar con este lenguaje al usarlo en variedad de circunstancias. Este taller presume en general ciertos conocimientos básicos en estadística, pero abundará en cada parte que se trabaje aunque sea algo como la motivación para las funciones que ejecutaremos. So no tienen experiencia en programación computacional, es posible que partes de este taller resulten confusas o no tengan mucho sentido. Recomiendo que aún así traten de entender lo que puedan, y luego al volver a este taller periódicamente al repasar el contenido, vayan comprendiendo (o trayendo preguntas que no se resuelvan) el material.</p>
<p>Es importante que sepan que la habilidad más útil de antemano es la de saber adónde ir cuando se atasquen. R ayuda bastante en esto. La consola de R, al escribir y ejecutar comandos, brinda retroalimentación inmediata. Hagan uso de esto de manera liberal mientras trabajan el taller, haciendo pequeñas modificaciones a los ejemplos que brinde, hasta que sientan que entienden qué está ocurriendo.</p>
<p>De una vez, cabe señalar que la consola brinda acceso a la función de buscar ayuda interna. Casi todas las funciones (y muchos de los datos pre-almacenados) tienen archivos que les acompañan describiendo qué son las funciones, y cómo usarlas. Pueden acceder a esta información escribiendo <code>help(función)</code> (o <code>?función</code>), sustituyendo «función» por el nombre de la función que quieras conocer. Es importante leer estos archivos detenidamente la primera vez que te encuentres con una función, pero <em>también</em> (posiblemente más) importante es consultarlos con frecuencia. Si tienes una idea de qué quieres hacer, pero no sabes ni recuerdas la función exacta para esto, puedes buscar en los archivos por el término usando doble signo de interrogación (<code>??regression</code>).</p>
<p>Hay mucha información adicional en internet. Es difícil buscar en Google por R, ya que es una letra, pero sí se puede encontrar mucho sobre funcionalidades. Para búsqueda más certera se puede ir a <a href="http://stackoverflow.com/">StackOverflow</a>, y buscar el tag de R (<code>[R]</code>) junto a tu pregunta o error. Relacionado está el <a href="http://stats.stackexchange.com/">StackExchange de estadísticas</a>, que es como Stack Overflow pero enfocado en la madeja estadística.</p>
<p>Finalmente, antes de empezar, quiero hablar sobre errores. Tanto novatos como expertos encontrarán errores en su código de R. De suceder, al ir ejecutando un <em>script</em> o trabajo, cesará el proceso y saldrá impreso un mensaje de error en la consola. Esto puede ser frustrante, en especial al estar iniciando el aprendizaje, pues el error ocurre a menudo muy adentro de las especificidades de una función, y el mensaje de error no guarda relación con lo que el usuario quería hacer. Un error a evitar al empezar a aprender R es que el error es un disparate incomprensible, y resignarse a la frustración y desánimo. Resistan ese impulso; si bien el mensaje no será de inicio informativo, está diseñado para transmitir cierta información con claridad, y entender esa información es clave para resolver el problema (o cambiar de estrategias).</p>
<p>Esta es una secuencia de tres semanas, y en esta lección arrancaremos con lo básico de R, RStudio, y tenemos la meta hoy de que al culminar las primeras dos horas de esta secuencia podamos:</p>
<ol type="1">
<li><p>Entender la lógica de RStudio.</p></li>
<li><p>Importar, crear, leer y manipular datos y objetos.</p></li>
<li><p>Inicios de la visualización y análisis descriptivo.</p></li>
</ol>
<p>Durante las próximas tres semanas expandiremos sobre esta base, y profundizaremos el viernes 3 de octubre en visualización avanzada, para datos transversales, series de tiempo, y datos censales así como de otros acercamientos, usando herramientas de <code>ggplot2</code> y <code>sf</code>. Luego, la tercera semana, el viernes 10 de octubre, entraremos más en <em>wrangling</em> de datos, así como en la inferencia estadística, con introducciones en R sobre modelos lineales, jerárquicos y longitudinales, así como de los distintos métodos de verificación de presunciones de modelo. Si bien hay mucho más que se puede hacer con R (e.g.&nbsp;<em>machine learning,</em> extracción de datos de la web, procesamiento de cadenas y minería de textos, interacción con Git, trabajos en Unix, o nuevos desarrollos en Quarto), la idea es iniciar la travesía en R, y señalar a dónde pueden buscar ahondar.</p>
<section id="usando-rstudio-y-presentando-por-encima-quarto" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="usando-rstudio-y-presentando-por-encima-quarto"><span class="header-section-number">2.1</span> Usando RStudio (y presentando por encima, Quarto)</h2>
<p>¿Cómo difieren R y RStudio? RStudio es una interfaz que yace encima del programa base R. Es además <u><strong>mucho</strong></u> más amigable y llevadera que R.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="R.png" class="img-fluid figure-img"></p>
<figcaption>Consola R: ejecuta comandos a la medida que se escriben.</figcaption>
</figure>
</div>
<p>R, por su cuenta es una consola sencilla donde teclean y corren código.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="RStudioPanes.jpeg" class="img-fluid figure-img"></p>
<figcaption>RStudio con varios paneles, incluyendo la consola inicial de R (abajo a la izquierda).</figcaption>
</figure>
</div>
<p>RStudio tiene la <em>Consola</em> como panel, pero tiene otros paneles en adición que nos ayudan a ubicarnos, como <em>Environment</em> (Ambiente) - para que vean los objetos (conjuntos de datos y variables, o funciones) que hayan guardado o creado a través de la sesión <em>-</em> el de <em>Output</em> (Salida) - donde pueden ver sus archivos en el directorio, sus gráficos, acceder los paquetes y buscar ayuda - y <em>Source</em> (Fuente), donde pueden crear y editar tanto archivos o <em>scripts</em> de R, como de Markdown, <a href="https://quarto.org/docs/get-started/hello/rstudio.html">Quarto</a> y <a href="https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html">Shiny</a> (para dashboards), entre otros formatos.</p>
<p>Estos paneles (y otras configuraciones) son editables, como el caso del R que manejo en mi Mac:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="RStudio.png" class="img-fluid figure-img"></p>
<figcaption>Otra forma posible de configuración.</figcaption>
</figure>
</div>
<p>A grosso modo, RMarkdown/Quarto es un tipo de documento que permite la escritura de texto regular junto a secciones o pedazos de R. Esto es útil para explicar por ejemplo tu código, seguido por el código mismo para uso regular. También es útil porque Markdown/Quarto se puede exportar como una página html así como un PDF, o Word lo cual es útil para compartirlo fuera del esquema de R. Si les interesara más sobre RMarkdown, visiten esta <a href="https://rmarkdown.rstudio.com/lesson-1.html">página</a> o esta para Quarto <a href="https://quarto.org/docs/get-started/hello/rstudio.html">aquí</a>.</p>
</section>
</section>
<section id="interacción-con-la-consola-de-r" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Interacción con la consola de R</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dslabs","wooldridge","tidyverse") #Si ya están instalados, comenten con '#' para desactivar esta línea</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la forma básica, R es una calculadora para cómputos básicos. Escribe en R (o en un trozo o <strong>chunk</strong> en RMarkdown o Quarto) y el resultado saldrá en la consola al ejecutar o correrlo. Un <strong>chunk</strong> se designa en Markdown con triple ` al inicio y fin, así como {r título de sección}. Ahí va el código. Hoy nos enfocaremos en R, pero esta presentación se hizo en RMarkdown. Pueden correr líneas de su secuencia de códigos al usar Command+Return en Mac, o Control+Enter en la PC. También hay un botón para correr líneas o secciones enteras, así como el <em>script</em> entero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">^</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">81</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<section id="asignando-valores-a-objetos" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="asignando-valores-a-objetos"><span class="header-section-number">3.1</span> Asignando valores a objetos</h2>
<p>Claro, R es mucho más que una calculadora básica. La computación con R incluye asignar valores a objetos, y esto se puede hacer con dos maneras básicamente equivalentes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En ambos casos, <code>x</code> representará <code>4</code> y R guardará ese significado para las líneas subsiguientes, a menos que reasignes el valor de <code>x</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>Vale señalar que no se debe confundir la asignación de valor a un objeto (o variable) como una igualdad. Al pensar lo que vimos, debiéramos pensar que <em>asignamos 4 a x</em> o <em>x recibe 4</em> o <em>x tiene 4</em>, mas no <em>x es igual a 4</em>. Aunque <code>=</code> es consistente con otros lenguajes de programación, muchos preferimos <code>&lt;-</code> al hacer la acción tomada a cabo más evidente. Si tenían curiosidad, se prueba la igualdad con doble signo de igualdad (<code>==</code>), y eso produce algo distinto:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">==</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">==</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Está bien usar nombres de variables como <code>x</code> para ejemplos matemáticos simples como los anteriores. Sin embargo, cuando escribas código para realizar análisis, debes tener cuidado de usar nombres descriptivos. El código donde las cosas se llaman <code>id_sujeto</code>, <code>condición</code> o <code>edad</code> serán más largos que <code>x</code>, <code>y</code> y <code>z</code>, pero tendrán <strong>mucho</strong> más sentido al volver a ellos meses después al hacer sus artículos o trabajos de investigación. Hay, eso sí, ciertas reglas para nombres: pueden ser cualquier carácter alfanumérico, pero el primer carácter ha de ser una letra. No se permiten espacios: la computadora no entiende que quieres trabajar con dos palabras como si fuera un concepto; son dos términos separados. En ese caso considera unir palabras con <code>_</code> y <code>.</code>. R también puede trabajar con datos categóricos, no sólo numéricos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="st">"Puerto Rico"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Puerto Rico"</code></pre>
</div>
</div>
<p>Noten las comillas. ¿Qué pasa si no llevara comillas?</p>
<p>También podemos asignar valores lógicos como cierto, <code>TRUE</code> y falso, <code>FALSE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>alive <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>asleep <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pueden comparar también valores numéricos con &gt;, &lt;, !=, &lt;= y &gt;=, que devolverán valores lógicos <code>TRUE</code> o <code>FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">&lt;=</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">!=</span> <span class="dv">4</span> <span class="co">#-&gt; noten: el símbolo complejo "!=" significa "no es igual a".</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Una vez hayan asignado valor numérico a objetos o variables, podrán hacer cálculos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>psic <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>soci <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>econ <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>cipo <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>antr <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>geog <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>otro_cs <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>otras_f <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>taller_n <span class="ot">=</span> psic <span class="sc">+</span> soci <span class="sc">+</span> econ <span class="sc">+</span> cipo <span class="sc">+</span> antr <span class="sc">+</span> geog <span class="sc">+</span> otro_cs <span class="sc">+</span> otras_f</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"La cantidad de participantes en el taller hoy es "</span>,taller_n, <span class="st">"."</span>)) <span class="co"># cantidad de participantes del taller</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La cantidad de participantes en el taller hoy es 11."</code></pre>
</div>
</div>
</section>
<section id="funciones" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="funciones"><span class="header-section-number">3.2</span> Funciones</h2>
<p>Las <strong>funciones</strong> en R son útiles para operaciones complejas. Toman en sí insumos de <em>argumentos</em> o <em>parámetros</em>, hacen su operación y devuelven unas salidas o resultados. Ustedes <em>llaman</em> a la función al escribir el nombre seguido de paréntesis, con los argumentos necesarios. Por ejemplo <code>print()</code> y <code>paste0</code> arriba. También podemos crear funciones propias:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mediana_mín_máx <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">mediana =</span> qs[<span class="dv">1</span>], mín <span class="ot">=</span> qs[<span class="dv">2</span>], máx <span class="ot">=</span> qs[<span class="dv">3</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hay varias funciones en R básico que son útiles en matemáticas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="sc">-</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">1.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5596158</code></pre>
</div>
</div>
<p>Normalmente usaremos <code>c()</code>, la función de concatenación. Esta toma una secuencia de argumentos y la encadena en un <strong>vector</strong>. La mayoría de las funciones de estadísticas descriptivas esperan recibir al menos un vector, o algo similar a ello.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 5 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mediana_mín_máx(a)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(a)<span class="co">#, fill = T) #concatena e imprime, menos complejo que print al no dar line feeds a menos que se explicite fill=T como argumento.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 5 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(a) <span class="co">#suma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(a) <span class="co">#media</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a) <span class="co">#desviación estándar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.516611</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.333333</code></pre>
</div>
</div>
</section>
</section>
<section id="importando-datos" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Importando datos</h1>
<p>Al recolectar datos en nuestros estudios, o al recibir datos pre-existentes de archivos estadísticos, es probable que nos encontremos con un archivo .csv, donde cada fila tenga la respuesta de un participante o un país, y una columna represente una variable, concepto o pregunta. Queremos importar esto a R para manipular estos datos (renombrarlos, crear nuevas variables de las existentes, fusionar conjuntos de datos que tengan puntos en común) y generar posiblemente estadísticas que resuman la información, así como analizar y visualizar las tendencias halladas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.1     ✔ stringr   1.5.2
✔ ggplot2   4.0.0     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># escribiendo un csv</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(mtcars, "mtcars.csv")</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load a csv file</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"mtcars.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (11): mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Esta importación es sencilla también con Stata o SPSS usando el paquete <code>haven</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">write_dta</span>(mtcars, <span class="st">"mtcars.dta"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">"mtcars.dta"</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">write_sav</span>(mtcars, <span class="st">"mtcars.sav"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"mtcars.sav"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez hayan importado los datos es probable que quieran echarle un vistazo a los datos, asegurarse que todo entró adecuadamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mira los nombres de las variables</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#recoge los datos básicos de las variables en el conjunto (e.g. observaciones, datos ausentes, mínimo, máximo, media)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mpg             cyl             disp             hp       
 Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
 Median :19.20   Median :6.000   Median :196.3   Median :123.0  
 Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
 Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
      drat             wt             qsec             vs        
 Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
 Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
 Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
 Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
       am              gear            carb      
 Min.   :0.0000   Min.   :3.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
 Median :0.0000   Median :4.000   Median :2.000  
 Mean   :0.4062   Mean   :3.688   Mean   :2.812  
 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :1.0000   Max.   :5.000   Max.   :8.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#las primeras filas</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2
6  18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#las últimas filas</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  26       4 120.     91  4.43  2.14  16.7     0     1     5     2
2  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2
3  15.8     8 351     264  4.22  3.17  14.5     0     1     5     4
4  19.7     6 145     175  3.62  2.77  15.5     0     1     5     6
5  15       8 301     335  3.54  3.57  14.6     0     1     5     8
6  21.4     4 121     109  4.11  2.78  18.6     1     1     4     2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#los tipos de variable</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [32 × 11] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ mpg : num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : num [1:32] 6 6 4 6 8 6 8 4 4 6 ...
 $ disp: num [1:32] 160 160 108 258 360 ...
 $ hp  : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...
 $ drat: num [1:32] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wt  : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: num [1:32] 16.5 17 18.6 19.4 17 ...
 $ vs  : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
 $ am  : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...
 $ gear: num [1:32] 4 4 4 3 3 3 3 4 4 4 ...
 $ carb: num [1:32] 4 4 1 1 2 1 4 2 2 4 ...
 - attr(*, "spec")=
  .. cols(
  ..   mpg = col_double(),
  ..   cyl = col_double(),
  ..   disp = col_double(),
  ..   hp = col_double(),
  ..   drat = col_double(),
  ..   wt = col_double(),
  ..   qsec = col_double(),
  ..   vs = col_double(),
  ..   am = col_double(),
  ..   gear = col_double(),
  ..   carb = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>Recuerden que para datos pre-existentes en R o paquetes, pueden buscar más información sobre los datos al poner <code>?[nombredatos]</code> en la consola. <code>mtcars</code> es uno de estos, así que podríamos ir a verificar en la pestaña de ayuda sobre los datos y el significado de estos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tipos-de-datos" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="tipos-de-datos"><span class="header-section-number">4.1</span> Tipos de datos</h2>
<p>Hay cuatro tipos de datos en R. Sabiendo de ellos podemos entender lsa limitaciones de análisis de cada uno, y también podrán entender mejor algunos errores que podrían recibir. Estos son:</p>
<ol type="1">
<li>Numéricos (números, enteros, dobles (aceptan los decimales))</li>
<li>Caracterers (strings)</li>
<li>Lógicos (C/F)</li>
<li>Factores (niveles discretos; e.g., categorías)</li>
</ol>
<p>Si ponemos la función <code>str(d)</code> notarán que cada variable tiene una asignatura de tipo. Pueden cambiar el tipo de datos, por ejemplo hacia categórico usando la función <code>as.factor()</code>. Ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [32 × 11] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ mpg : num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : num [1:32] 6 6 4 6 8 6 8 4 4 6 ...
 $ disp: num [1:32] 160 160 108 258 360 ...
 $ hp  : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...
 $ drat: num [1:32] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wt  : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: num [1:32] 16.5 17 18.6 19.4 17 ...
 $ vs  : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
 $ am  : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...
 $ gear: num [1:32] 4 4 4 3 3 3 3 4 4 4 ...
 $ carb: num [1:32] 4 4 1 1 2 1 4 2 2 4 ...
 - attr(*, "spec")=
  .. cols(
  ..   mpg = col_double(),
  ..   cyl = col_double(),
  ..   disp = col_double(),
  ..   hp = col_double(),
  ..   drat = col_double(),
  ..   wt = col_double(),
  ..   qsec = col_double(),
  ..   vs = col_double(),
  ..   am = col_double(),
  ..   gear = col_double(),
  ..   carb = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>am)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d<span class="sc">$</span>am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 2 levels "0","1": 2 2 2 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>En estos datos <code>am</code> nos informa si el vehículo usa transmisión automática (0) o manual (1). Estas son categorías en realidad, representadas por una variable dummy, pues es mejor reclasificarlas de ser números continuos a categorías: al usar <code>as.factor()</code> le dijimos a R que <code>am</code> era un factor. Puedes verificar manualmente el estado o transformación de una variable al usar <code>str(nombre_de_variable)</code>.</p>
</section>
<section id="el-operador-de-accesso" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="el-operador-de-accesso"><span class="header-section-number">4.2</span> El operador de accesso <code>$</code></h2>
<p>A menudo queremos no entender todos los datos (pueden ser muchos) sino entender algunas variables en específico. Podemos usar un código que permite acceder a la variable dentro de un objeto: <code>datos$nombre_var</code>–el conjunto de datos, un signo de peso o dólar, y el nombre de la variable. Por ejemplo, <code>d$cyl</code> es decirle a R <strong>“dentro del conjunto de datos <code>d</code>, la variable <code>cyl</code>”</strong>. Es importante en este punto especificar el conjunto que queremos acceder, pues tenemos varias opciones.</p>
<section id="apegándonos-de-un-conjunto-de-datos" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="apegándonos-de-un-conjunto-de-datos"><span class="header-section-number">4.2.1</span> Apegándonos de un conjunto de datos</h3>
<p>Es posible que quieran trabajar con sólo uno o mayormente uno de estos conjuntos de datos. Ahí podríamos usar la opción de <code>attach(datos)</code> mientras operas con esos datos, y luego <code>detach()</code> al terminar con ellos. En este caso, le decimos a R que asuma que al llamar la variable, nos referimos a los datos que ‘pegamos’ a la memoria.</p>
<p><em>Si bien esto puede ser conveniente, podría llevar a ciertos errores por olvido o por cambios en los datos, debe ser usado sin mucha frecuencia.</em></p>
<p>Aquí ‘pegamos’ ese conjunto de datos y hacemos una operación con la variable de automático o manual <code>am</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from package:ggplot2:

    mpg</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(am)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:32] 2 2 2 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.40625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4989909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(am)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 2 levels "1","2": 2 2 2 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sd(am) #dará error: no se puede aplicar esto a valores categóricos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si optaron por usar la función de <code>attach</code>, ¡asegúrense de ‘despegar’ el conjunto de datos al terminar las operaciones que iban a usar!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verificando-las-variables" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="verificando-las-variables"><span class="header-section-number">4.2.2</span> Verificando las variables</h3>
<p>Ahora que podemos acceder a las variables, podemos explorarlas con varias funciones existentes en R y paquetes adicionales. También podríamos crear nuestras propias funciones. Abajo algunas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(d<span class="sc">$</span>mpg, d<span class="sc">$</span>gear, mean) <span class="co">#aplica la función de promedio a la variable de mpg para verlos según la cantidad de cambios--3, 4 o 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       3        4        5 
16.10667 24.53333 21.38000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(d, mean) <span class="co"># promedia cada variable del conjunto en lista o vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
returning NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       mpg        cyl       disp         hp       drat         wt       qsec 
 20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
        vs         am       gear       carb 
  0.437500         NA   3.687500   2.812500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d<span class="sc">$</span>mpg) <span class="co">#estadísticas resumidas básicas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.40   15.43   19.20   20.09   22.80   33.90 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>carb, d<span class="sc">$</span>am) <span class="co">#tabla de frecuencias</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    0 1
  1 3 4
  2 6 4
  3 3 0
  4 7 3
  6 0 1
  8 0 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(d<span class="sc">$</span>carb, d<span class="sc">$</span>am, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">'núm. de carburadores'</span>,<span class="st">'transmisión'</span>))) <span class="co">#añade información adicional a la tabla</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    transmisión
núm. de carburadores  0  1 Sum
                 1    3  4   7
                 2    6  4  10
                 3    3  0   3
                 4    7  3  10
                 6    0  1   1
                 8    0  1   1
                 Sum 19 13  32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando la distribución</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d<span class="sc">$</span>wt, <span class="at">col =</span> <span class="st">'red3'</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">main =</span> <span class="st">'Distribución del peso'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>wt, <span class="at">ylab =</span> <span class="st">'Peso (en miles)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>wt<span class="sc">~</span>d<span class="sc">$</span>mpg,<span class="at">xlab=</span><span class="st">"Millas por galón"</span>,<span class="at">ylab=</span><span class="st">'Peso (en miles)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nota que para estas funciones lo que se <em>requiere</em> en realidad es el nombre de la variable como argumento. ¿Qué creen signifiquen las opciones <code>col =</code>, <code>xlab =</code>, <code>main =</code>, y <code>ylab =</code>?</p>
<p>Podríamos también agrupar la información como ocurre en estos casos abajo del paquete <code>psych</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("psych")</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(d<span class="sc">$</span>hp) <span class="co"># la función "describe" viene en el paquete de psych; da datos adicionales</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars  n   mean    sd median trimmed  mad min max range skew kurtosis    se
X1    1 32 146.69 68.56    123  141.19 77.1  52 335   283 0.73    -0.14 12.12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(d<span class="sc">$</span>mpg, d<span class="sc">$</span>am) <span class="co"># del paquete "psych"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
group: 0
   vars  n  mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 19 17.15 3.83   17.3   17.12 3.11 10.4 24.4    14 0.01     -0.8 0.88
------------------------------------------------------------ 
group: 1
   vars  n  mean   sd median trimmed  mad min  max range skew kurtosis   se
X1    1 13 24.39 6.17   22.8   24.38 6.67  15 33.9  18.9 0.05    -1.46 1.71</code></pre>
</div>
</div>
<p>Una forma más complicada pero útil de verificar estadísticas es la función <code>xtabs()</code>, es decir tabulación cruzada. El código pide una fórmula que contraste las variables. El código es un poco más complicado pero se puede interpretar como “la suma de <code>mpg</code>, para cada grupo de <code>cyl</code> y <code>am</code>”. Ya que <code>cyl</code> tiene tres grupos y <code>am</code> tiene dos grupos, <code>xtabs()</code> devuelve una tabla de seis celdas con las sumas de <code>mpg</code> para cada uno de estos grupos; así podríamos por ejemplo verificar como cambian las medias dadas ciertas categorías. Noten que hemos usado, sin <code>attach()</code> el nombre de las variables, ya que le dijimos a la función que se enfocara en las variables dentro del objeto definido en la opción <code>data = conjunto_de_datos</code> (aquí, <em>data</em> = d).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   am
cyl     0     1
  4  68.7 224.6
  6  76.5  61.7
  8 180.6  30.8</code></pre>
</div>
</div>
<p>Si queríamos el promedio de millas por galón por categoría hacemos lo siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sumamos mpg por categorías de cyl y am</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>suma_mpg <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sacamos la cantidad de observaciones por categorías de cyl y am obviando el lado izquierdo de la fórmula</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>cantidad <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Media de mpg por categorías de cyl y am</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>media_mpg <span class="ot">&lt;-</span> suma_mpg <span class="sc">/</span> cantidad</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>media_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   am
cyl        0        1
  4 22.90000 28.07500
  6 19.12500 20.56667
  8 15.05000 15.40000</code></pre>
</div>
</div>
<p>En este caso hemos obtenido la media de millas por galón según la cantidad de cilindros del vehículo, y si la transmisión era manual o automática.</p>
</section>
</section>
</section>
<section id="entendiendo-y-manipulando-datos-tidyverse" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Entendiendo y manipulando datos: Tidyverse</h1>
<p>Si bien podríamos usar esta información previa para entender los datos. Digamos que queremos saber qué carro es el mejor en estos datos en cuestión de millas por galón. Podríamos hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mpg"</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>?mpg</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> manufacturer          model               displ            year     
 Length:234         Length:234         Min.   :1.600   Min.   :1999  
 Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  
 Mode  :character   Mode  :character   Median :3.300   Median :2004  
                                       Mean   :3.472   Mean   :2004  
                                       3rd Qu.:4.600   3rd Qu.:2008  
                                       Max.   :7.000   Max.   :2008  
      cyl           trans               drv                 cty       
 Min.   :4.000   Length:234         Length:234         Min.   : 9.00  
 1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  
 Median :6.000   Mode  :character   Mode  :character   Median :17.00  
 Mean   :5.889                                         Mean   :16.86  
 3rd Qu.:8.000                                         3rd Qu.:19.00  
 Max.   :8.000                                         Max.   :35.00  
      hwy             fl               class          
 Min.   :12.00   Length:234         Length:234        
 1st Qu.:18.00   Class :character   Class :character  
 Median :24.00   Mode  :character   Mode  :character  
 Mean   :23.44                                        
 3rd Qu.:27.00                                        
 Max.   :44.00                                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mpg<span class="sc">$</span>hwy) <span class="co">#sin embargo esto no nos lleva a mucha más información</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>i_max<span class="ot">&lt;-</span><span class="fu">which.max</span>(mpg<span class="sc">$</span>hwy)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>mpg<span class="sc">$</span>model[i_max]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "jetta"</code></pre>
</div>
</div>
<p>El vehículo con mejor millaje por galón fue el Jetta. Igualmente si trabajamos datos de criminalidad en EEUU, podríamos tener</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(murders)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(murders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    state               abb                      region     population      
 Length:51          Length:51          Northeast    : 9   Min.   :  563626  
 Class :character   Class :character   South        :17   1st Qu.: 1696962  
 Mode  :character   Mode  :character   North Central:12   Median : 4339367  
                                       West         :13   Mean   : 6075769  
                                                          3rd Qu.: 6636084  
                                                          Max.   :37253956  
     total       
 Min.   :   2.0  
 1st Qu.:  24.5  
 Median :  97.0  
 Mean   : 184.4  
 3rd Qu.: 268.0  
 Max.   :1257.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(murders<span class="sc">$</span>total) <span class="co">#queremos igual aquí saber el estado que menos tuvo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>i_min<span class="ot">&lt;-</span><span class="fu">which.min</span>(murders<span class="sc">$</span>total)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>murders<span class="sc">$</span>state[i_min]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vermont"</code></pre>
</div>
</div>
<p>Y tendríamos este resultado, con Vermont como el que menos asesinatos de arma de fuego registrara en 2010.</p>
<p>Sin embargo esto no es suficiente quizás para todo lo que queremos hacer y se ve demasiado laborioso o largo en relación a lo que obtenemos. En el caso de los datos de asesinatos por arma de fuego, hemos buscado el estado con menos asesinatos, y vemos que hay un rango enorme entre ése y el mayor, pero ¿estamos comparando chinas con chinas?</p>
<section id="modificando-conjuntos-de-datos-creando-una-variable" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="modificando-conjuntos-de-datos-creando-una-variable"><span class="header-section-number">5.1</span> Modificando conjuntos de datos: creando una variable</h2>
<p>Podríamos crear una tasa de asesinatos para este último conjunto de datos, con la información ya suministrada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>murders<span class="sc">$</span>tasa_100k<span class="ot">&lt;-</span>murders<span class="sc">$</span>total<span class="sc">/</span>murders<span class="sc">$</span>population <span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(murders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       state abb region population total tasa_100k
1    Alabama  AL  South    4779736   135  2.824424
2     Alaska  AK   West     710231    19  2.675186
3    Arizona  AZ   West    6392017   232  3.629527
4   Arkansas  AR  South    2915918    93  3.189390
5 California  CA   West   37253956  1257  3.374138
6   Colorado  CO   West    5029196    65  1.292453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#en tidyverse esto se puede hacer con la función mutate()</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>murders<span class="ot">&lt;-</span><span class="fu">mutate</span>(murders,<span class="at">tasa=</span>total<span class="sc">/</span>population<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(murders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       state abb region population total tasa_100k     tasa
1    Alabama  AL  South    4779736   135  2.824424 2.824424
2     Alaska  AK   West     710231    19  2.675186 2.675186
3    Arizona  AZ   West    6392017   232  3.629527 3.629527
4   Arkansas  AR  South    2915918    93  3.189390 3.189390
5 California  CA   West   37253956  1257  3.374138 3.374138
6   Colorado  CO   West    5029196    65  1.292453 1.292453</code></pre>
</div>
</div>
<p>Digamos que ahora queremos ver una lista más informativa e intuitiva de los datos; por ejemplo, qué otros carros figuran con buen millaje por galón:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mpg, hwy<span class="sc">&gt;=</span><span class="dv">35</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 11
  manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 honda        civic        1.8  2008     4 auto(… f        25    36 r     subc…
2 honda        civic        1.8  2008     4 auto(… f        24    36 c     subc…
3 toyota       corolla      1.8  1999     4 manua… f        26    35 r     comp…
4 toyota       corolla      1.8  2008     4 manua… f        28    37 r     comp…
5 toyota       corolla      1.8  2008     4 auto(… f        26    35 r     comp…
6 volkswagen   jetta        1.9  1999     4 manua… f        33    44 d     comp…
7 volkswagen   new beetle   1.9  1999     4 manua… f        35    44 d     subc…
8 volkswagen   new beetle   1.9  1999     4 auto(… f        29    41 d     subc…</code></pre>
</div>
</div>
<p>En este caso hemos seleccionado las filas para visualizar que tienen millaje por galón superior a 35: hemos creado un <strong>subconjunto</strong>.</p>
</section>
<section id="el-operador-pipe-o" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="el-operador-pipe-o"><span class="header-section-number">5.2</span> El operador pipe <code>%&gt;%</code> o <code>|&gt;</code></h2>
<p>Digamos que realmente queremos reducir la cantidad de columnas en las que queremos enfocarnos, pues los datos de <code>mpg</code> tienen demasiadas. Podríamos crear otro subconjunto:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>tabla_nueva_mpg<span class="ot">&lt;-</span><span class="fu">select</span>(mpg,model,year,cty,hwy)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tabla_nueva_mpg, hwy<span class="sc">&gt;=</span><span class="dv">35</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  model       year   cty   hwy
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 civic       2008    25    36
2 civic       2008    24    36
3 corolla     1999    26    35
4 corolla     2008    28    37
5 corolla     2008    26    35
6 jetta       1999    33    44
7 new beetle  1999    35    44
8 new beetle  1999    29    41</code></pre>
</div>
</div>
<p>Y nos quedamos con cuatro columnas dándonos información puntual si esto era lo que nos interesaba. Sin embargo, podríamos evitarnos la creación de objetos intermedios al usar la función que canaliza los datos en secuencia funcional así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> <span class="fu">select</span>(model,year,cty,hwy) <span class="sc">|&gt;</span> <span class="fu">filter</span>(hwy<span class="sc">&gt;=</span><span class="dv">35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  model       year   cty   hwy
  &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;int&gt;
1 civic       2008    25    36
2 civic       2008    24    36
3 corolla     1999    26    35
4 corolla     2008    28    37
5 corolla     2008    26    35
6 jetta       1999    33    44
7 new beetle  1999    35    44
8 new beetle  1999    29    41</code></pre>
</div>
</div>
<p><em>Vale la pena señalar que el</em> pipe <em>funcionará bien con las funciones donde el primer argumento sean los datos de entrada, que canalizamos. Las funciones de tidyr y dplyr operan así y se acoplan al</em> pipe<em>.</em></p>
</section>
<section id="resumiendo-datos-explorativamente-con-tidy" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="resumiendo-datos-explorativamente-con-tidy"><span class="header-section-number">5.3</span> Resumiendo datos explorativamente con Tidy</h2>
<p>En esta sección cubriremos dos funciones de tidyverse, en dplyr, <code>summarise</code> y <code>group_by</code>. La primera, <code>summarise</code>, ofrece el cálculo de estadísticas de resumen con un código legible e intuitivo. El segundo agrupa y resume los datos por categorías inherente en las variables existentes. Por ejemplo, quizás quisiéramos calcular el promedio y desviación estándar de los vehículos en los datos de millaje por galón, pero queremos agruparlos por fabricante, o tipo de transmisión, o cualquier otro tipo de variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mpg_grupal=</span><span class="fu">mean</span>(hwy),</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ds_grupal=</span><span class="fu">sd</span>(hwy)) <span class="co">#por fabricador</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
   manufacturer mpg_grupal ds_grupal
   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;
 1 audi               26.4      2.18
 2 chevrolet          21.9      5.11
 3 dodge              17.9      3.57
 4 ford               19.4      3.33
 5 honda              32.6      2.55
 6 hyundai            26.9      2.18
 7 jeep               17.6      3.25
 8 land rover         16.5      1.73
 9 lincoln            17        1   
10 mercury            18        1.15
11 nissan             24.6      5.09
12 pontiac            26.4      1.14
13 subaru             25.6      1.16
14 toyota             24.9      6.17
15 volkswagen         29.2      5.32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trans) <span class="sc">|&gt;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mpg_grupal=</span><span class="fu">mean</span>(hwy),</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ds_grupal=</span><span class="fu">sd</span>(hwy)) <span class="co">#por año de manufactura</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   trans      mpg_grupal ds_grupal
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1 auto(av)         27.8      2.59
 2 auto(l3)         27        4.24
 3 auto(l4)         22.0      5.64
 4 auto(l5)         20.7      6.04
 5 auto(l6)         20        2.37
 6 auto(s4)         25.7      1.15
 7 auto(s5)         25.3      6.66
 8 auto(s6)         25.2      3.99
 9 manual(m5)       26.3      5.99
10 manual(m6)       24.2      5.75</code></pre>
</div>
</div>
<p>Podemos también aplicar una función creada previamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(mediana_mín_máx(hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   manufacturer mediana   mín   máx
   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 audi            26      23    31
 2 chevrolet       23      14    30
 3 dodge           17      12    24
 4 ford            18      15    26
 5 honda           32      29    36
 6 hyundai         26.5    24    31
 7 jeep            18.5    12    22
 8 land rover      16.5    15    18
 9 lincoln         17      16    18
10 mercury         18      17    19
11 nissan          26      17    32
12 pontiac         26      25    28
13 subaru          26      23    27
14 toyota          26      15    37
15 volkswagen      29      23    44</code></pre>
</div>
</div>
<p>Digamos que queremos obtener las tasas medias de regiones específicas en los EEUU. En este caso entra más complicación pero en Tidyverse podemos usar tanto el pipe <code>%&gt;%</code> como la <code>%in%</code> (el %in% es una función que busca parear la entrada de un valor mapeado en otro):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ME"</span>, <span class="st">"NH"</span>, <span class="st">"VT"</span>, <span class="st">"MA"</span>, <span class="st">"RI"</span>, <span class="st">"CT"</span>) <span class="sc">~</span> <span class="st">"Nueva Inglaterra"</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span>) <span class="sc">~</span> <span class="st">"Costa del Pacífico"</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otras regiones"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa_100k =</span> <span class="fu">sum</span>(total)<span class="sc">/</span> <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  group              tasa_100k
  &lt;chr&gt;                  &lt;dbl&gt;
1 Costa del Pacífico      2.90
2 Nueva Inglaterra        1.72
3 Otras regiones          2.71
4 el Sur                  3.63</code></pre>
</div>
</div>
</section>
</section>
<section id="visualización-de-datos-porqués" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Visualización de datos: porqués</h1>
<p>Ver números y cadenas de caracteres que forman un conjunto de datos puede ser interesante, o no, pero normalmente no tiene tanta utilidad. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wage1)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wage1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  wage educ exper tenure nonwhite female married numdep smsa northcen south
1 3.10   11     2      0        0      1       0      2    1        0     0
2 3.24   12    22      2        0      1       1      3    1        0     0
3 3.00   11     2      0        0      0       0      2    0        0     0
4 6.00    8    44     28        0      0       1      0    1        0     0
5 5.30   12     7      2        0      0       1      1    0        0     0
6 8.75   16     9      8        0      0       1      0    1        0     0
  west construc ndurman trcommpu trade services profserv profocc clerocc
1    1        0       0        0     0        0        0       0       0
2    1        0       0        0     0        1        0       0       0
3    1        0       0        0     1        0        0       0       0
4    1        0       0        0     0        0        0       0       1
5    1        0       0        0     0        0        0       0       0
6    1        0       0        0     0        0        1       1       0
  servocc    lwage expersq tenursq
1       0 1.131402       4       0
2       1 1.175573     484       4
3       0 1.098612       4       0
4       0 1.791759    1936     784
5       0 1.667707      49       4
6       0 2.169054      81      64</code></pre>
</div>
</div>
<p>¿Qué aprendemos de ver estos datos así? ¿Podemos rápidamente determinar a si años de educación se traducen a mayores ingresos? ¿Podemos determinar si afecta en algo la relación marital? Para muchos humanos, es difícil extraer información con meramente mirar a números sin contexto adicional. Pero podríamos ver algo en este gráfico</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Relación.png" class="img-fluid figure-img"></p>
<figcaption>Meta 1.ª: datos de ingreso, que continuaremos al abundar en modelos inferenciales el miércoles que viene.</figcaption>
</figure>
</div>
<p>Lo mismo podríamos hacer con los datos que trabajamos la semana pasada de homicidios con armas de fuego en EEUU:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"murders"</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(murders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           state abb        region population total
46       Vermont  VT     Northeast     625741     2
47      Virginia  VA         South    8001024   250
48    Washington  WA          West    6724540    93
49 West Virginia  WV         South    1852994    27
50     Wisconsin  WI North Central    5686986    97
51       Wyoming  WY          West     563626     5</code></pre>
</div>
</div>
<p>No podemos determinar con facilidad a qué estado le toca la población más grande o pequeña, y si existe alguna relación entre el tamaño de población y el total de asesinatos, o de cómo varían las tasas de asesinatos por regiones de estados en la federación estadounidense. Sin embargo, eso puede responderse sin muchas palabras con el próximo gráfico.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Meta.png" class="img-fluid figure-img"></p>
<figcaption>Gráfico de la meta 2.ª</figcaption>
</figure>
</div>
<p>Una imagen vale más que mil palabras dice el dicho. Sin adentrarnos a la inferencia estadística (que cubriremos en la tercera semana de esta secuencia de talleres), hemos podido comunicar relaciones y hallazgos en datos. A veces puede ser este ejercicio uno tan convincente que no requiera análisis subsiguientes.</p>
<p>Vivimos en una era de creciente disponibilidad de conjuntos de datos informativos y de herramientas de software, con lo cual el uso de visualizaciones ha aumentado en diversos espacios: académicos, gubernamentales, organizaciones sociales, prensa, e industrias varias.</p>
<p>En R, una de las principales maneras con la que trabajaremos estos análisis visuales es de la mano de <code>ggplot2</code>, así como con otros paquetes que ayudan a procesar esta información. Si bien existen otros métodos de graficar en R y otros programas, la preferencia de este taller es utilizar el sistema de procesamiento que ofrece <code>tidyverse</code>, con <code>ggplot2</code> incluido.</p>
<p>Esta es una secuencia de tres semanas, y en esta lección continuamos con lo aprendido la semana anterior, donde terminamos con visualizaciones sencillas y con el uso de <code>tidyverse</code> para manejar datos. Tenemos la meta hoy de que al culminar las segundas dos horas de esta secuencia podamos:</p>
<ol type="1">
<li><p>Entender cómo usar la gramática de gráficas</p></li>
<li><p>Entender cómo usar <code>ggplot2</code>, continuando con lo aprendido de <code>tidyverse</code> de la semana pasada.</p></li>
<li><p>Entender cómo utilizar en varias maneras <code>tidycensus</code> para generar mapas.</p></li>
</ol>
<p>En la próxima sesión, del 10 de octubre, entraremos más en <em>wrangling</em> de datos, así como en la inferencia estadística, con introducciones en R sobre modelos lineales, jerárquicos y longitudinales, así como sus diagnósticos posteriores.</p>
</section>
<section id="ggplot2" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> ggplot2</h1>
<p>R ofrece varias opciones para graficar, siendo útiles las capacidades incluidas en su instalación básica. Además, existen paquetes como <code>grid</code>, que permite un control preciso de los elementos gráficos, y <code>lattice</code>, que facilita la creación de gráficos multivariados y en paneles o facetas. Sin embargo, en este taller (y en los libros de referencia usados y descritos arriba) se ha optado por usar <code>ggplot2</code>, ya que permite a los principiantes crear gráficos complejos y estéticos mediante una sintaxis intuitiva y fácil de recordar, dividiendo los gráficos en componentes básicos.</p>
<p><code>ggplot2</code> destaca por su uso de una <u><em>g</em></u><em>ramática de <u>g</u>ráficos</em> – de donde vienen las primeras dos g – que simplifica el proceso de creación de gráficos. Al aprender unos pocos componentes esenciales de esta gramática, los usuarios pueden generar una amplia variedad de gráficos con facilidad. Además, su comportamiento por defecto está diseñado para producir resultados agradables y funcionales con código conciso y legible, lo que facilita su uso por principiantes. Como factor limitante está el que está diseñado para trabajar con tablas de formato <em>tidy</em> (con filas con observaciones y columnas conteniendo variables), pero un número sustancial de conjuntos de datos se trabajan en ese formato, o pueden convertirse a ese formato.</p>
<section id="componentes-de-un-gráfico" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="componentes-de-un-gráfico"><span class="header-section-number">7.1</span> Componentes de un gráfico</h2>
<p>Hoy construiremos varios tipos de gráficos como los que vimos arriba, así como mapas informativos. Antes que todo eso, vale señalar que los gráficos se dividen en tres componentes principales. Usaré otro gráfico que creara en 2020 durante la pandemia del Coronavirus para ejemplificar estos componentes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Covid.png" class="img-fluid figure-img"></p>
<figcaption>Datos para ejemplificar</figcaption>
</figure>
</div>
<ul>
<li><strong>Datos</strong>:
<ul>
<li>Estoy pasando al gráfico un conjunto de datos que corté sobre fatalidad de casos de COVID-19 hasta el 31 de julio de 2020 (los datos continúan hasta 2023).</li>
<li>Este es el componente de <em>datos</em> del gráfico.</li>
</ul></li>
<li><strong>Geometrías</strong>:
<ul>
<li>El gráfico es uno de líneas, útil para varias series de tiempo. Este componente es una <em>geometría</em>. Otras geometrías posibles son gráficos de dispersión, histogramas, diagramas de barras, densidades suavizadas, y diagrama de cajas, entre otros.</li>
</ul></li>
<li><strong>Mapeo estético</strong>:
<ul>
<li>El gráfico usa señales visuales para representar en el lienzo vacío con capas distintos tipos de información provista en el conjunto de datos:
<ul>
<li>Posiciones en el eje de x (tiempo)</li>
<li>Posiciones en el eje de y (tasas de mortandad observadas)</li>
<li>Color (asignado por país)</li>
</ul></li>
<li>Cada línea representa la información de un país para una serie de fechas. Estos se aclaran con una etiqueta para aclararnos esa relación de línea-color-país.</li>
<li>El <em>mapeo estético</em> depende de la geometría utilizada.</li>
</ul></li>
<li><strong>Observaciones adicionales</strong>:<br>

<ul>
<li>Ejes <em>x</em> e <em>y</em> definidos por el rango de los datos y ambos en escalas logarítmicas.</li>
<li>El gráfico incluye etiquetas, un título, etiquetas de variables, nota al calce, y el tema utilizado es uno solarizado que pareciera no muy distante al utilizado por el periódico especializado “The Financial Times”.</li>
</ul></li>
<li>Volveremos luego a estos datos para construir esta imagen si nos da tiempo en el taller, y si no, tendrán disponible el cómo hacerlo para referencia.</li>
</ul>
</section>
<section id="lienzo-vacío-y-capas" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="lienzo-vacío-y-capas"><span class="header-section-number">7.2</span> Lienzo vacío y capas</h2>
<p>Manteniéndonos cerca de los datos utilizados en la semana pasada, construiremos por <strong><em>capas</em></strong> la información que va en el gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span> <span class="fu">ggplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Un%20lienzo%20en%20blanco-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El primer paso de crear un gráfico de ggplot es asignar los datos a un lienzo vacío. Esto no significa poblar el lienzo con esos datos, sino pasarle al programa la información inicial, como un pintor que selecciona el tema que usará para la pintura que visualiza en su mente. Esto lo hicimos al pasar el <em>pipe</em> (<code>|&gt;</code> o <code>|&gt;</code>) los datos a ggplot, y lo que ocurrió fue que al no darle más información (capas, como la pintura en un lienzo), nos quedó un recuadro gris enmarcado por un borde blanco.</p>
<p>En ggplot, la información entonces se suministra al lienzo por capas, y se le pueden añadir adicionales. Esto tomará la forma de código siguiente:</p>
<div class="line-block">DATOS |&gt; ggplot() + CAPA 1 +<br>
CAPA 2 + … + CAPA N</div>
<p>Usualmente, la primera capa que añadimos define la geometría. Si queremos hacer un diagrama de dispersión, ¿qué geometría deberíamos utilizar?</p>
<p>Si vemos la hoja de referencia (en la carpeta del taller 2, o accesible en esta página: <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf</a>), vemos que la función utilizada para crear gráficos con esta geometría puntillista es <code>geom_point</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20una%20geometría-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este caso ya hemos dado un paso adicional y añadido una primera capa en esta obra: le indicamos que queremos una capa que tenga una geometría de puntos, y un mapeo estético que toma las coordenadas en un plano cartesiano donde el eje de equis queda definido como <code>population/10^6</code>, la población de los estados o Wáshington D.C., en millones; el eje de ye queda definido entonces como el total de asesinatos con armas de fuego. En el mapeo estético entonces los puntos quedan asignados a esas coordenadas. De esta manera, las distancias entre puntos, así como otras características que queramos añadir, quedan expresadas. Esto se da a través de la función <code>aes</code>. Esta será de las funciones que más usen al graficar.</p>
<p>Noten que hasta ahora hemos trabajado este lienzo sin guardarlo como objeto. Si bien esto puede funcionar bien, es posible que queramos guardar nuestro progreso y seguir añadiendo capas adicionales. En este caso, al ejecutar el comando y guardarlo en objeto, el programa no nos dará automáticamente una actualización del gráfico; tendremos que llamar al objeto para que aparezca:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total),<span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Tenemos entonces nuestro gráfico de dispersión inicial. Quizás no es tan informativo pero vemos una serie de puntos con el mapeo estético inicial. Noten que podríamos quitar la <code>x=</code> y la <code>y=</code> y no pasaría nada, ya que en ausencia de esta especificación, el programa entiende por defecto que lo primero que se le asigna es la información del eje horizontal, y en segundo orden el vertical:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total, <span class="at">label =</span> abb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20etiquetas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aquí he añadido una geometría nueva: texto. Hay dos geometrías para esto, <code>geom_label</code> y <code>geom_text</code>, uno con el texto enmarcado en un recuadro y el segundo sin ello. Ya que cada punto (cada jurisdicción que es realmente parte de los Estados Unidos de América en este caso) tiene una etiqueta, necesitamos un mapeo estético para hacer la conexión entre los puntos y las etiquetas, así que se le asignó el mismo tal que el texto cayera exactamente en la misma coordenada que el punto. Pero esto se puede corregir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total, <span class="at">label =</span> abb),<span class="at">nudge_x =</span> <span class="fl">1.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Empujando%20etiquetas%20en%20el%20eje-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#nudge_y desplazaría el texto en el eje de y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En este caso hemos empujado a través del eje de equis la etiqueta de texto con un valor numérico de 1.5. Valores mayores aumentarían la distancia del texto y el punto, mientras que menores harían lo contrario.</p>
<p>Ahora podremos seguir con una complicación en el mapeo estético: queremos añadir una capa de color al lienzo que represente regiones de estas jurisdicciones. Esto se hace al añadir la opción de <code>colour</code> y dándole una variable, en este caso <code>region</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico base con puntos coloreados por región</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> murders <span class="sc">|&gt;</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">colour =</span> region), <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20color-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora paso nuevamente a añadir etiquetas abreviadas, con el color por región.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir etiquetas desplazadas en el eje x (con color por región)</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>p <span class="sc">+</span> </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label =</span> abb, <span class="at">colour =</span> region), <span class="at">nudge_x =</span> <span class="fl">1.5</span>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20nuevamente%20etiquetas%20de%20abreviación%20jurisdiccional-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Y para darle más información al gráfico le añadimos etiquetas y títulos que sean más informativas que los nombres de variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#démosle más información a la gráfica de dispersión.</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Población (en millones)"</span>,   <span class="co"># Cambia el nombre del eje x</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Homicidios con arma de fuego"</span>,            <span class="co"># Cambia el nombre del eje y</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">colour =</span> <span class="st">"Región"</span>,              <span class="co"># Cambia el nombre de la leyenda de color</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Homicidios con arma de fuego en EEUU, 2010"</span>  <span class="co"># Título del gráfico</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20títulos-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hasta ahora hemos ido añadiendo capas pero notamos que tenemos una gran concentración de puntos en la parte inferior izquierda del lienzo: la mayoría de las jurisdicciones tienen menos de 10 millones de habitantes y menos de 400 homicidios. Esto hace leer e interpretar lo que sucede en para estos casos difícil. Podríamos entonces representar el gráfico con una transformación logarítmica al re-escalar con <code>scale_x_continuous</code> y <code>scale_y_continuous</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">colour =</span> region), <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label =</span> abb),<span class="at">nudge_x =</span> <span class="fl">0.05</span>)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>p2<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>)<span class="sc">+</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> <span class="st">"log10"</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>p2<span class="sc">+</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Población (millones, escala log.)"</span>,   <span class="co"># Cambia el nombre del eje x</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Homicidios por arma de fuego (escala log.)"</span>,            <span class="co"># Cambia el nombre del eje y</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Región"</span>,              <span class="co"># Cambia el nombre de la leyenda de color</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Homicidios por arma de fuego vs población, por región"</span>  <span class="co"># Título del gráfico</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Haciendo%20una%20transformación%20de%20escala-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Podríamos añadir una capa temática, usando el paquete <code>ggthemes</code>, que tiene un catálogo estético variado, que recomiendo verifiquen a través de <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="uri">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a>. Esto es en adición a los que ya ofrece el paquete de <code>ggplot2</code> <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="uri">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>.</p>
<p>En este caso le añadiré una visualización al estilo del semanario británico <em>The Economist.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20temas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="el-gráfico-que-buscábamos" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="el-gráfico-que-buscábamos"><span class="header-section-number">7.3</span> El gráfico que buscábamos</h2>
<p>Normalmente queremos añadir formas o anotaciones a las figuras que no se derivan directamente del mapeo estético; algunos ejemplos incluyen etiquetas, cuadros, áreas sombreadas y líneas. Si queremos añadir una línea que represente la tasa promedio de asesinatos en todos los Estados Unidos, tendremos que determinarlo aparte con la ayuda de <code>dplyr</code> (parte de <code>tidyverse</code>), y tendremos que hacer la transformación adecuada también (logarítmica):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> murders <span class="sc">|&gt;</span> </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa =</span> <span class="fu">sum</span>(total) <span class="sc">/</span>  <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(tasa)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span> </span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(región<span class="ot">=</span><span class="fu">case_when</span>(</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Northeast"</span> <span class="sc">~</span> <span class="st">"Noreste"</span>,</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"North Central"</span> <span class="sc">~</span> <span class="st">"el Midwest"</span>,</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"West"</span> <span class="sc">~</span> <span class="st">"Oeste"</span>,</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>))<span class="sc">|&gt;</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total)) <span class="sc">+</span>   </span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">log10</span>(t), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) <span class="sc">+</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> región), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> abb)) <span class="sc">+</span> </span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Homicidios en EEUU con arma de fuego en 2010"</span>,</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Población (en millones, escala log.)"</span>, </span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Homicidios por arma de fuego (en escala log.)"</span>,</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Región"</span>) <span class="sc">+</span></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/el%20gráfico%20que%20buscábamos%20(datos%20de%20asesinatos)-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>He aquí los pasos entonces que necesitábamos para recrear la imagen arriba.’</p>
</section>
<section id="gráficos-rápidos-qplot" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="gráficos-rápidos-qplot"><span class="header-section-number">7.4</span> Gráficos rápidos: <code>qplot()</code></h2>
<p>Si bien esto ha sido útil y han podido ver cómo generar gráficas complejas siguiendo la gramática de gráficos, es probable que en algún momento quieran ver rápidamente unas relaciones visuales de manera instantánea, con la intención luego de volver y darle mejor forma y seguir las complicaciones de un gráfico de <code>ggplot2</code> con todas sus capas. La opción que da <code>ggplot2</code> a esto es el uso de <code>qplot()</code>.</p>
<p>Por ejemplo, aquí modifiqué los grupos de jurisdicciones de Estados Unidos a unos grupos específicos, y creo un gráfico para ver densidades con relleno (<code>fill=grupo</code>) y con líneas que también sirven para demarcar estos grupos de manera distinta (e.g.&nbsp;línea sólida, línea entrecortada). Noten que ha corrido todo el gráfico de la última línea.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>murdersg<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasa=</span> total<span class="sc">/</span>population <span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">grupo =</span> <span class="fu">case_when</span>(</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ME"</span>, <span class="st">"NH"</span>, <span class="st">"VT"</span>, <span class="st">"MA"</span>, <span class="st">"RI"</span>, <span class="st">"CT"</span>) <span class="sc">~</span> <span class="st">"Nueva Inglaterra"</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span>) <span class="sc">~</span> <span class="st">"Costa del Pacífico"</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otras regiones"</span>))</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(tasa, <span class="at">data =</span> murdersg, <span class="at">geom=</span> <span class="st">"density"</span>, <span class="at">fill =</span> grupo, <span class="at">linetype=</span>grupo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Un%20qplot%20inicial-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En las siguientes líneas pido y ejecuto variaciones de gráficos con qplot con los datos de altura del libro de Irizarry:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heights)            </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>heights<span class="sc">|&gt;</span><span class="fu">ggplot</span>()</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom=</span> <span class="st">"boxplot"</span>, <span class="at">fill =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Varios%20qplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom=</span> <span class="st">"violin"</span>, <span class="at">fill =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Varios%20qplots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"dotplot"</span>,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">stackdir =</span> <span class="st">"center"</span>, <span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">dotsize =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Varios%20qplots-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"density"</span>, <span class="at">fill =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Varios%20qplots-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"density"</span>, <span class="at">color =</span> sex, <span class="at">linetype =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Varios%20qplots-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nuevamente podríamos mostrar información adicional, como medias añadidas fuera de las estéticas definidas dentro del mapeo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>mu_alt<span class="ot">&lt;-</span>heights <span class="sc">|&gt;</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media=</span><span class="fu">mean</span>(height))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>c<span class="ot">&lt;-</span>heights<span class="sc">|&gt;</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height))</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sex), <span class="at">alpha=</span><span class="fl">0.4</span>) <span class="co">#el alpha le da un nivel de transparencia </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Dando%20a%20densidades%20transparencias-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#¿qué creen que pase si suben el valor a 0.9 o lo reducen a 0.1?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Noten que si tenemos dos categorías, al pedir color, tiende a establecer a uno con un rojo magenta y al segundo con un azul cian (aciano o ciano), en este caso suavizado y transparentado para poder ver las distribuciones. Sin embargo, podemos editar el color manualmente, a la vez que añadimos complicaciones como una media de alturas por grupo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu_alt, <span class="fu">aes</span>(<span class="at">xintercept=</span>media, <span class="at">color=</span>sex),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>)) <span class="co">#noten que aquí le di los colores con código alfanumérico, un gris plateado y un dorado.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Añadiendo%20color%20manualmente-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hay varios métodos para asignar colores al nombrarlos en R. Se puede hacer por nombre (en inglés), con códigos alfanúmericos, y se puede también importar paletas de colores con paquetes específicos. Considero útil revisar las opciones en este enlace: <a href="https://r-graph-gallery.com/ggplot2-color.html" class="uri">https://r-graph-gallery.com/ggplot2-color.html</a></p>
</section>
<section id="alcanzando-visualización-de-densidades-y-sus-cambios-a-través-del-tiempo" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="alcanzando-visualización-de-densidades-y-sus-cambios-a-través-del-tiempo"><span class="header-section-number">7.5</span> Alcanzando visualización de densidades y sus cambios a través del tiempo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,545 × 9
   country   year infant_mortality life_expectancy fertility population      gdp
   &lt;fct&gt;    &lt;int&gt;            &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
 1 Albania   1960            115.             62.9      6.19    1636054 NA      
 2 Algeria   1960            148.             47.5      7.65   11124892  1.38e10
 3 Angola    1960            208              36.0      7.32    5270844 NA      
 4 Antigua…  1960             NA              63.0      4.43      54681 NA      
 5 Argenti…  1960             59.9            65.4      3.11   20619075  1.08e11
 6 Armenia   1960             NA              66.9      4.55    1867396 NA      
 7 Aruba     1960             NA              65.7      4.82      54208 NA      
 8 Austral…  1960             20.3            70.9      3.45   10292328  9.67e10
 9 Austria   1960             37.3            68.8      2.7     7065525  5.24e10
10 Azerbai…  1960             NA              61.3      5.57    3897889 NA      
# ℹ 10,535 more rows
# ℹ 2 more variables: continent &lt;fct&gt;, region &lt;fct&gt;</code></pre>
</div>
</div>
<p>Vemos que estos datos incluyen una variedad de información a nivel de país, que incluye un número de años para ellos.</p>
<p>Podemos ver los grupos de países por continentes usando una matriz de gráficos, con cuadrículas paradas y acostadas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(continent<span class="sc">~</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">col =</span> continent)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2012</span>,<span class="dv">2015</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Europe"</span>, <span class="st">"Asia"</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> continent <span class="sc">%in%</span> continents) <span class="sc">|&gt;</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(fertility, life_expectancy, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Fertilidad"</span>, <span class="at">y=</span><span class="st">"Esperanza de vida"</span>,<span class="at">colour=</span><span class="st">"Continente"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En este caso podemos apreciar mejor cómo la dispersión y distribución de países entre los años 1960s y el presente reciente ha ido encaminado a una convergencia en estándares de vida, dejando atrás los puntos donde originaron estereotipos que aún persisten sobre cómo son las vidas y experiencias de distintas regiones del planeta (sin desestimar diferencias e inequidades presentes).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> <span class="fu">mutate</span>(dólares<span class="at">_diarios =</span> gdp<span class="sc">/</span>population<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>antaño <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">reorder</span>(region, dólares_diarios, <span class="at">FUN =</span> median)) <span class="sc">|&gt;</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, region)) <span class="sc">+</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Creando%20visualización%20sobre%20ingresos%20diarios-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupo =</span> <span class="fu">case_when</span>(</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Western Europe"</span>, <span class="st">"Northern Europe"</span>,<span class="st">"Southern Europe"</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Northern America"</span>,</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Australia and New Zealand"</span>) <span class="sc">~</span> <span class="st">"Occidente"</span>,</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Eastern Asia"</span>, <span class="st">"South-Eastern Asia"</span>) <span class="sc">~</span> <span class="st">"Asia oriental"</span>,</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Caribbean"</span>, <span class="st">"Central America"</span>,</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"South America"</span>) <span class="sc">~</span> <span class="st">"Latinoamérica"</span>,</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>    continent <span class="sc">==</span> <span class="st">"Africa"</span> <span class="sc">&amp;</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">!=</span> <span class="st">"Northern Africa"</span> <span class="sc">~</span> <span class="st">"África subsahariana"</span>,</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otros"</span>))</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co">#le damos orden a los niveles</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupo =</span> <span class="fu">factor</span>(grupo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Otros"</span>, <span class="st">"Latinoamérica"</span>,</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Asia oriental"</span>, <span class="st">"África subsahariana"</span>,</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Occidente"</span>)))</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(grupo, dólares_diarios)) <span class="sc">+</span></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Creando%20categorías%20para%20ver%20mejor%20dinámicas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="co">#añadiendo puntos para ver mejor distribuciones y cantidad de casos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Creando%20categorías%20para%20ver%20mejor%20dinámicas-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, grupo)) <span class="sc">+</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density_ridges</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.648</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Densidades-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density_ridges</span>(<span class="at">jittered_points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">position =</span> <span class="fu">position_points_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">point_shape =</span> <span class="st">'|'</span>, <span class="at">point_size =</span> <span class="dv">3</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">point_alpha =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.648</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Densidades%20con%20información%20de%20observaciones-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>antaño <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>año_presente <span class="ot">&lt;-</span> <span class="dv">2010</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(antaño, año_presente)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">west =</span> <span class="fu">ifelse</span>(grupo <span class="sc">==</span> <span class="st">"Occidente"</span>, <span class="st">"Occidente"</span>, <span class="st">"El Resto"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios)) <span class="sc">+</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> west)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Histogramas%20comparativos%20en%20facetas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Sabemos que muchos países surgieron después de 1970 (razón por la cual el histograma se nutre para el grupo <strong>El Resto</strong>), así que para comparar los países que tienen toda la información y han existido consistentemente entre esos periodos y ver si hay cambios y de dónde surgen en distribuciones podemos hacer lo siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>country_list_1 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>country_list_2 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> año_presente <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>country_list <span class="ot">&lt;-</span> <span class="fu">intersect</span>(country_list_1, country_list_2)</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(grupo, dólares_diarios)) <span class="sc">+</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Wrangling%20para%20comparar%20chinas%20con%20chinas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, grupo)) <span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">adjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_density_ridges(adjust = 1.5): Ignoring unknown parameters:
`adjust`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.648</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.726</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Wrangling%20para%20comparar%20chinas%20con%20chinas-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, <span class="at">fill =</span> grupo)) <span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">bw =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> .)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidades apiladas: ingreso en dólares por día per cápita entre 1970 y 2010"</span>,</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Dólares por día"</span>, </span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Regiones"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Ignoring unknown labels:
• colour : "Regiones"</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller1_files/figure-html/Wrangling%20para%20comparar%20chinas%20con%20chinas-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="recapitulando" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Recapitulando</h1>
<section id="qué-aprendimos-en-este-taller-inicial" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="qué-aprendimos-en-este-taller-inicial"><span class="header-section-number">8.1</span> Qué aprendimos en este taller inicial</h2>
<p>Hoy aprendimos varias cosas para empezar a usar R:</p>
<ul>
<li>Hablamos sobre cómo descargar e instalar R y RStudio;</li>
<li>Funcionalidades posibles, como Markdown;</li>
<li>Funciones y jerga específica de R;</li>
<li>Cómo cargar datos y visualizarlos;</li>
<li>Cómo buscar estadísticas básicas;</li>
<li>Cómo llevar a cabo operaciones transformadoras a los datos;</li>
<li>Empezamos a usar la sintaxis de tidyverse.</li>
</ul>
</section>
<section id="continuamos-el-próximo-martes" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="continuamos-el-próximo-martes"><span class="header-section-number">8.2</span> Continuamos el próximo martes</h2>
<p>En el siguiente taller talleres que vienen continuaremos ahondando en operaciones estadísticas, visualización más avanzada, estadística inferencial y análisis de redes. Gracias por asistir hoy.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb189" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "CACCS: Taller de RStudio - 1ª parte"</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Rashid C.J. Marcano Rivera, Ph.D., M.S., M.A."</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "13 de nov.ᵉ de 2025"</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cerulean</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: true</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: monokai</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Para cuando añadas bibliografía:</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a><span class="co"># bibliography: "Referencias.bib"</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a><span class="co"># csl: "apa.csl"</span></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a><span class="co"># reference-location: section</span></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introducción</span></span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>**Introducción a la computación estadística en R**</span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>Este taller está basado en notas de Paul Thibodeau y revisiones de profesores del departamento de psicología de BYU <span class="co">[</span><span class="ot">(vea esa versión aquí)</span><span class="co">](https://fhssrsc.byu.edu/r-workshop)</span>. Adaptado al español y usando ejemplos del libro de Rafael Irizarry <span class="co">[</span><span class="ot">disponible aquí</span><span class="co">](https://leanpub.com/dslibro)</span>. Ha sido revisado de la primeras versión de este taller, brindadas en el Centro Académico de Cómputos de Ciencias Sociales en los pasados semestres.</span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>*Si aún no has instalado R, está disponible [aquí](http://cran.us.r-project.org/). Acto seguido, [baja RStudio](https://posit.co/download/rstudio-desktop/). Puedes también ir a la nube [en Posit Cloud](https://posit.cloud/).*</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a><span class="fu"># Sobre aprender R</span></span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a>R es un lenguaje creado por estadísticos como ambiente interactivo para análisis de datos. En R pueden guardar su trabajo como una secuencia de comandos, conocida como un *script*, que se pueden ejecutar fácilmente en cualquier momento, con portabilidad. Estos *scripts* sirven como un registro del análisis que realizaron, una característica clave que facilita el trabajo [***reproducible***]{.underline}. Si bien es un programa poderoso y flexible, es ciertamente más complicado que programados como el que puedan encontrar en SPSS o STATA, donde pueden señalar con el ratón una opción y ejecutarla. Por otro lado, R es gratuito y de código abierto. En adición es modular y las funcionalidades añadidas complementariamente por terceros también son gratuitos, incluyendo acceso temprano a los métodos y herramientas más recientes que se desarrollan para una amplia variedad de disciplinas, incluyendo la economía, ciencias políticas, sociología, planificación, ecología, geografía o la biología molecular, entre otros.</span>
<span id="cb189-34"><a href="#cb189-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-35"><a href="#cb189-35" aria-hidden="true" tabindex="-1"></a>Mi idea tras esta secuencia de talleres sobre R es brindar una introducción para que puedan interactuar con R tal que los sentimientos de frustración o ansiedad que puedan surgir al trabajar con este lenguaje al usarlo en variedad de circunstancias. Este taller presume en general ciertos conocimientos básicos en estadística, pero abundará en cada parte que se trabaje aunque sea algo como la motivación para las funciones que ejecutaremos. So no tienen experiencia en programación computacional, es posible que partes de este taller resulten confusas o no tengan mucho sentido. Recomiendo que aún así traten de entender lo que puedan, y luego al volver a este taller periódicamente al repasar el contenido, vayan comprendiendo (o trayendo preguntas que no se resuelvan) el material.</span>
<span id="cb189-36"><a href="#cb189-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-37"><a href="#cb189-37" aria-hidden="true" tabindex="-1"></a>Es importante que sepan que la habilidad más útil de antemano es la de saber adónde ir cuando se atasquen. R ayuda bastante en esto. La consola de R, al escribir y ejecutar comandos, brinda retroalimentación inmediata. Hagan uso de esto de manera liberal mientras trabajan el taller, haciendo pequeñas modificaciones a los ejemplos que brinde, hasta que sientan que entienden qué está ocurriendo.</span>
<span id="cb189-38"><a href="#cb189-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-39"><a href="#cb189-39" aria-hidden="true" tabindex="-1"></a>De una vez, cabe señalar que la consola brinda acceso a la función de buscar ayuda interna. Casi todas las funciones (y muchos de los datos pre-almacenados) tienen archivos que les acompañan describiendo qué son las funciones, y cómo usarlas. Pueden acceder a esta información escribiendo <span class="in">`help(función)`</span> (o <span class="in">`?función`</span>), sustituyendo «función» por el nombre de la función que quieras conocer. Es importante leer estos archivos detenidamente la primera vez que te encuentres con una función, pero *también* (posiblemente más) importante es consultarlos con frecuencia. Si tienes una idea de qué quieres hacer, pero no sabes ni recuerdas la función exacta para esto, puedes buscar en los archivos por el término usando doble signo de interrogación (<span class="in">`??regression`</span>).</span>
<span id="cb189-40"><a href="#cb189-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-41"><a href="#cb189-41" aria-hidden="true" tabindex="-1"></a>Hay mucha información adicional en internet. Es difícil buscar en Google por R, ya que es una letra, pero sí se puede encontrar mucho sobre funcionalidades. Para búsqueda más certera se puede ir a <span class="co">[</span><span class="ot">StackOverflow</span><span class="co">](http://stackoverflow.com/)</span>, y buscar el tag de R (<span class="in">`[R]`</span>) junto a tu pregunta o error. Relacionado está el <span class="co">[</span><span class="ot">StackExchange de estadísticas</span><span class="co">](http://stats.stackexchange.com/)</span>, que es como Stack Overflow pero enfocado en la madeja estadística.</span>
<span id="cb189-42"><a href="#cb189-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-43"><a href="#cb189-43" aria-hidden="true" tabindex="-1"></a>Finalmente, antes de empezar, quiero hablar sobre errores. Tanto novatos como expertos encontrarán errores en su código de R. De suceder, al ir ejecutando un *script* o trabajo, cesará el proceso y saldrá impreso un mensaje de error en la consola. Esto puede ser frustrante, en especial al estar iniciando el aprendizaje, pues el error ocurre a menudo muy adentro de las especificidades de una función, y el mensaje de error no guarda relación con lo que el usuario quería hacer. Un error a evitar al empezar a aprender R es que el error es un disparate incomprensible, y resignarse a la frustración y desánimo. Resistan ese impulso; si bien el mensaje no será de inicio informativo, está diseñado para transmitir cierta información con claridad, y entender esa información es clave para resolver el problema (o cambiar de estrategias).</span>
<span id="cb189-44"><a href="#cb189-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-45"><a href="#cb189-45" aria-hidden="true" tabindex="-1"></a>Esta es una secuencia de tres semanas, y en esta lección arrancaremos con lo básico de R, RStudio, y tenemos la meta hoy de que al culminar las primeras dos horas de esta secuencia podamos:</span>
<span id="cb189-46"><a href="#cb189-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-47"><a href="#cb189-47" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Entender la lógica de RStudio.</span>
<span id="cb189-48"><a href="#cb189-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-49"><a href="#cb189-49" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Importar, crear, leer y manipular datos y objetos.</span>
<span id="cb189-50"><a href="#cb189-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-51"><a href="#cb189-51" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Inicios de la visualización y análisis descriptivo.</span>
<span id="cb189-52"><a href="#cb189-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-53"><a href="#cb189-53" aria-hidden="true" tabindex="-1"></a>Durante las próximas tres semanas expandiremos sobre esta base, y profundizaremos el viernes 3 de octubre en visualización avanzada, para datos transversales, series de tiempo, y datos censales así como de otros acercamientos, usando herramientas de <span class="in">`ggplot2`</span> y <span class="in">`sf`</span>. Luego, la tercera semana, el viernes 10 de octubre, entraremos más en *wrangling* de datos, así como en la inferencia estadística, con introducciones en R sobre modelos lineales, jerárquicos y longitudinales, así como de los distintos métodos de verificación de presunciones de modelo. Si bien hay mucho más que se puede hacer con R (e.g. *machine learning,* extracción de datos de la web, procesamiento de cadenas y minería de textos, interacción con Git, trabajos en Unix, o nuevos desarrollos en Quarto), la idea es iniciar la travesía en R, y señalar a dónde pueden buscar ahondar.</span>
<span id="cb189-54"><a href="#cb189-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-55"><a href="#cb189-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Usando RStudio (y presentando por encima, Quarto)</span></span>
<span id="cb189-56"><a href="#cb189-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-57"><a href="#cb189-57" aria-hidden="true" tabindex="-1"></a>¿Cómo difieren R y RStudio? RStudio es una interfaz que yace encima del programa base R. Es además <span class="co">[</span><span class="ot">**mucho**</span><span class="co">]</span>{.underline} más amigable y llevadera que R.</span>
<span id="cb189-58"><a href="#cb189-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-59"><a href="#cb189-59" aria-hidden="true" tabindex="-1"></a><span class="al">![Consola R: ejecuta comandos a la medida que se escriben.](R.png)</span></span>
<span id="cb189-60"><a href="#cb189-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-61"><a href="#cb189-61" aria-hidden="true" tabindex="-1"></a>R, por su cuenta es una consola sencilla donde teclean y corren código.</span>
<span id="cb189-62"><a href="#cb189-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-63"><a href="#cb189-63" aria-hidden="true" tabindex="-1"></a><span class="al">![RStudio con varios paneles, incluyendo la consola inicial de R (abajo a la izquierda).](RStudioPanes.jpeg)</span></span>
<span id="cb189-64"><a href="#cb189-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-65"><a href="#cb189-65" aria-hidden="true" tabindex="-1"></a>RStudio tiene la *Consola* como panel, pero tiene otros paneles en adición que nos ayudan a ubicarnos, como *Environment* (Ambiente) - para que vean los objetos (conjuntos de datos y variables, o funciones) que hayan guardado o creado a través de la sesión *-* el de *Output* (Salida) - donde pueden ver sus archivos en el directorio, sus gráficos, acceder los paquetes y buscar ayuda - y *Source* (Fuente), donde pueden crear y editar tanto archivos o *scripts* de R, como de Markdown, <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org/docs/get-started/hello/rstudio.html)</span> y <span class="co">[</span><span class="ot">Shiny</span><span class="co">](https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html)</span> (para dashboards), entre otros formatos.</span>
<span id="cb189-66"><a href="#cb189-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-67"><a href="#cb189-67" aria-hidden="true" tabindex="-1"></a>Estos paneles (y otras configuraciones) son editables, como el caso del R que manejo en mi Mac:</span>
<span id="cb189-68"><a href="#cb189-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-69"><a href="#cb189-69" aria-hidden="true" tabindex="-1"></a><span class="al">![Otra forma posible de configuración.](RStudio.png)</span></span>
<span id="cb189-70"><a href="#cb189-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-71"><a href="#cb189-71" aria-hidden="true" tabindex="-1"></a>A grosso modo, RMarkdown/Quarto es un tipo de documento que permite la escritura de texto regular junto a secciones o pedazos de R. Esto es útil para explicar por ejemplo tu código, seguido por el código mismo para uso regular. También es útil porque Markdown/Quarto se puede exportar como una página html así como un PDF, o Word lo cual es útil para compartirlo fuera del esquema de R. Si les interesara más sobre RMarkdown, visiten esta <span class="co">[</span><span class="ot">página</span><span class="co">](https://rmarkdown.rstudio.com/lesson-1.html)</span> o esta para Quarto <span class="co">[</span><span class="ot">aquí</span><span class="co">](https://quarto.org/docs/get-started/hello/rstudio.html)</span>.</span>
<span id="cb189-72"><a href="#cb189-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-73"><a href="#cb189-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Interacción con la consola de R</span></span>
<span id="cb189-74"><a href="#cb189-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-75"><a href="#cb189-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paquetes que instalar luego}</span></span>
<span id="cb189-76"><a href="#cb189-76" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dslabs","wooldridge","tidyverse") #Si ya están instalados, comenten con '#' para desactivar esta línea</span></span>
<span id="cb189-77"><a href="#cb189-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-78"><a href="#cb189-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-79"><a href="#cb189-79" aria-hidden="true" tabindex="-1"></a>En la forma básica, R es una calculadora para cómputos básicos. Escribe en R (o en un trozo o **chunk** en RMarkdown o Quarto) y el resultado saldrá en la consola al ejecutar o correrlo. Un **chunk** se designa en Markdown con triple <span class="sc">\`</span> al inicio y fin, así como {r título de sección}. Ahí va el código. Hoy nos enfocaremos en R, pero esta presentación se hizo en RMarkdown. Pueden correr líneas de su secuencia de códigos al usar Command+Return en Mac, o Control+Enter en la PC. También hay un botón para correr líneas o secciones enteras, así como el *script* entero.</span>
<span id="cb189-80"><a href="#cb189-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-81"><a href="#cb189-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r calculadora básica}</span></span>
<span id="cb189-82"><a href="#cb189-82" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb189-83"><a href="#cb189-83" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb189-84"><a href="#cb189-84" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">^</span> <span class="dv">6</span></span>
<span id="cb189-85"><a href="#cb189-85" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span>)</span>
<span id="cb189-86"><a href="#cb189-86" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">81</span>)</span>
<span id="cb189-87"><a href="#cb189-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-88"><a href="#cb189-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-89"><a href="#cb189-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Asignando valores a objetos</span></span>
<span id="cb189-90"><a href="#cb189-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-91"><a href="#cb189-91" aria-hidden="true" tabindex="-1"></a>Claro, R es mucho más que una calculadora básica. La computación con R incluye asignar valores a objetos, y esto se puede hacer con dos maneras básicamente equivalentes:</span>
<span id="cb189-92"><a href="#cb189-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-93"><a href="#cb189-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creando un objeto}</span></span>
<span id="cb189-94"><a href="#cb189-94" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb189-95"><a href="#cb189-95" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb189-96"><a href="#cb189-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-97"><a href="#cb189-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-98"><a href="#cb189-98" aria-hidden="true" tabindex="-1"></a>En ambos casos, <span class="in">`x`</span> representará <span class="in">`4`</span> y R guardará ese significado para las líneas subsiguientes, a menos que reasignes el valor de <span class="in">`x`</span>.</span>
<span id="cb189-99"><a href="#cb189-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-100"><a href="#cb189-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r alterando valor de objeto}</span></span>
<span id="cb189-101"><a href="#cb189-101" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb189-102"><a href="#cb189-102" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb189-103"><a href="#cb189-103" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb189-104"><a href="#cb189-104" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb189-105"><a href="#cb189-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-106"><a href="#cb189-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-107"><a href="#cb189-107" aria-hidden="true" tabindex="-1"></a>Vale señalar que no se debe confundir la asignación de valor a un objeto (o variable) como una igualdad. Al pensar lo que vimos, debiéramos pensar que *asignamos 4 a x* o *x recibe 4* o *x tiene 4*, mas no *x es igual a 4*. Aunque <span class="in">`=`</span> es consistente con otros lenguajes de programación, muchos preferimos <span class="in">`&lt;-`</span> al hacer la acción tomada a cabo más evidente. Si tenían curiosidad, se prueba la igualdad con doble signo de igualdad (<span class="in">`==`</span>), y eso produce algo distinto:</span>
<span id="cb189-108"><a href="#cb189-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-109"><a href="#cb189-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r equality_tests}</span></span>
<span id="cb189-110"><a href="#cb189-110" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb189-111"><a href="#cb189-111" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb189-112"><a href="#cb189-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-113"><a href="#cb189-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-114"><a href="#cb189-114" aria-hidden="true" tabindex="-1"></a>Está bien usar nombres de variables como <span class="in">`x`</span> para ejemplos matemáticos simples como los anteriores. Sin embargo, cuando escribas código para realizar análisis, debes tener cuidado de usar nombres descriptivos. El código donde las cosas se llaman <span class="in">`id_sujeto`</span>, <span class="in">`condición`</span> o <span class="in">`edad`</span> serán más largos que <span class="in">`x`</span>, <span class="in">`y`</span> y <span class="in">`z`</span>, pero tendrán **mucho** más sentido al volver a ellos meses después al hacer sus artículos o trabajos de investigación. Hay, eso sí, ciertas reglas para nombres: pueden ser cualquier carácter alfanumérico, pero el primer carácter ha de ser una letra. No se permiten espacios: la computadora no entiende que quieres trabajar con dos palabras como si fuera un concepto; son dos términos separados. En ese caso considera unir palabras con <span class="in">`_`</span> y <span class="in">`.`</span>. R también puede trabajar con datos categóricos, no sólo numéricos:</span>
<span id="cb189-115"><a href="#cb189-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-116"><a href="#cb189-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r asignando valores categóricos}</span></span>
<span id="cb189-117"><a href="#cb189-117" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="st">"Puerto Rico"</span></span>
<span id="cb189-118"><a href="#cb189-118" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb189-119"><a href="#cb189-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-120"><a href="#cb189-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-121"><a href="#cb189-121" aria-hidden="true" tabindex="-1"></a>Noten las comillas. ¿Qué pasa si no llevara comillas?</span>
<span id="cb189-122"><a href="#cb189-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-123"><a href="#cb189-123" aria-hidden="true" tabindex="-1"></a>También podemos asignar valores lógicos como cierto, <span class="in">`TRUE`</span> y falso, <span class="in">`FALSE`</span>:</span>
<span id="cb189-124"><a href="#cb189-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-125"><a href="#cb189-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r valores lógicos}</span></span>
<span id="cb189-126"><a href="#cb189-126" aria-hidden="true" tabindex="-1"></a>alive <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb189-127"><a href="#cb189-127" aria-hidden="true" tabindex="-1"></a>asleep <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb189-128"><a href="#cb189-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-129"><a href="#cb189-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-130"><a href="#cb189-130" aria-hidden="true" tabindex="-1"></a>Pueden comparar también valores numéricos con <span class="sc">\&gt;</span>, <span class="sc">\&lt;</span>, !=, <span class="sc">\&lt;</span>= y <span class="sc">\&gt;</span>=, que devolverán valores lógicos <span class="in">`TRUE`</span> o <span class="in">`FALSE`</span>.</span>
<span id="cb189-131"><a href="#cb189-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-134"><a href="#cb189-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-135"><a href="#cb189-135" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">3</span></span>
<span id="cb189-136"><a href="#cb189-136" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">&lt;=</span> <span class="dv">3</span></span>
<span id="cb189-137"><a href="#cb189-137" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">!=</span> <span class="dv">4</span> <span class="co">#-&gt; noten: el símbolo complejo "!=" significa "no es igual a".</span></span>
<span id="cb189-138"><a href="#cb189-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-139"><a href="#cb189-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-140"><a href="#cb189-140" aria-hidden="true" tabindex="-1"></a>Una vez hayan asignado valor numérico a objetos o variables, podrán hacer cálculos:</span>
<span id="cb189-141"><a href="#cb189-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-144"><a href="#cb189-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-145"><a href="#cb189-145" aria-hidden="true" tabindex="-1"></a>psic <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-146"><a href="#cb189-146" aria-hidden="true" tabindex="-1"></a>soci <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb189-147"><a href="#cb189-147" aria-hidden="true" tabindex="-1"></a>econ <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-148"><a href="#cb189-148" aria-hidden="true" tabindex="-1"></a>cipo <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-149"><a href="#cb189-149" aria-hidden="true" tabindex="-1"></a>antr <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb189-150"><a href="#cb189-150" aria-hidden="true" tabindex="-1"></a>geog <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-151"><a href="#cb189-151" aria-hidden="true" tabindex="-1"></a>otro_cs <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb189-152"><a href="#cb189-152" aria-hidden="true" tabindex="-1"></a>otras_f <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb189-153"><a href="#cb189-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-154"><a href="#cb189-154" aria-hidden="true" tabindex="-1"></a>taller_n <span class="ot">=</span> psic <span class="sc">+</span> soci <span class="sc">+</span> econ <span class="sc">+</span> cipo <span class="sc">+</span> antr <span class="sc">+</span> geog <span class="sc">+</span> otro_cs <span class="sc">+</span> otras_f</span>
<span id="cb189-155"><a href="#cb189-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-156"><a href="#cb189-156" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"La cantidad de participantes en el taller hoy es "</span>,taller_n, <span class="st">"."</span>)) <span class="co"># cantidad de participantes del taller</span></span>
<span id="cb189-157"><a href="#cb189-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-158"><a href="#cb189-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-159"><a href="#cb189-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Funciones</span></span>
<span id="cb189-160"><a href="#cb189-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-161"><a href="#cb189-161" aria-hidden="true" tabindex="-1"></a>Las **funciones** en R son útiles para operaciones complejas. Toman en sí insumos de *argumentos* o *parámetros*, hacen su operación y devuelven unas salidas o resultados. Ustedes *llaman* a la función al escribir el nombre seguido de paréntesis, con los argumentos necesarios. Por ejemplo <span class="in">`print()`</span> y <span class="in">`paste0`</span> arriba. También podemos crear funciones propias:</span>
<span id="cb189-162"><a href="#cb189-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-163"><a href="#cb189-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creando una función}</span></span>
<span id="cb189-164"><a href="#cb189-164" aria-hidden="true" tabindex="-1"></a>mediana_mín_máx <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb189-165"><a href="#cb189-165" aria-hidden="true" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb189-166"><a href="#cb189-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">mediana =</span> qs[<span class="dv">1</span>], mín <span class="ot">=</span> qs[<span class="dv">2</span>], máx <span class="ot">=</span> qs[<span class="dv">3</span>])</span>
<span id="cb189-167"><a href="#cb189-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb189-168"><a href="#cb189-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-169"><a href="#cb189-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-170"><a href="#cb189-170" aria-hidden="true" tabindex="-1"></a>Hay varias funciones en R básico que son útiles en matemáticas:</span>
<span id="cb189-171"><a href="#cb189-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-172"><a href="#cb189-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r funciones de matemáticas}</span></span>
<span id="cb189-173"><a href="#cb189-173" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb189-174"><a href="#cb189-174" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">64</span>)</span>
<span id="cb189-175"><a href="#cb189-175" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">1.75</span>)</span>
<span id="cb189-176"><a href="#cb189-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-177"><a href="#cb189-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-178"><a href="#cb189-178" aria-hidden="true" tabindex="-1"></a>Normalmente usaremos <span class="in">`c()`</span>, la función de concatenación. Esta toma una secuencia de argumentos y la encadena en un **vector**. La mayoría de las funciones de estadísticas descriptivas esperan recibir al menos un vector, o algo similar a ello.</span>
<span id="cb189-179"><a href="#cb189-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-180"><a href="#cb189-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r vectores básicos}</span></span>
<span id="cb189-181"><a href="#cb189-181" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb189-182"><a href="#cb189-182" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span>
<span id="cb189-183"><a href="#cb189-183" aria-hidden="true" tabindex="-1"></a><span class="co">#mediana_mín_máx(a)</span></span>
<span id="cb189-184"><a href="#cb189-184" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(a)<span class="co">#, fill = T) #concatena e imprime, menos complejo que print al no dar line feeds a menos que se explicite fill=T como argumento.</span></span>
<span id="cb189-185"><a href="#cb189-185" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(a) <span class="co">#suma</span></span>
<span id="cb189-186"><a href="#cb189-186" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(a) <span class="co">#media</span></span>
<span id="cb189-187"><a href="#cb189-187" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(a) <span class="co">#desviación estándar</span></span>
<span id="cb189-188"><a href="#cb189-188" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(a)</span>
<span id="cb189-189"><a href="#cb189-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-190"><a href="#cb189-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-191"><a href="#cb189-191" aria-hidden="true" tabindex="-1"></a><span class="fu"># Importando datos</span></span>
<span id="cb189-192"><a href="#cb189-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-193"><a href="#cb189-193" aria-hidden="true" tabindex="-1"></a>Al recolectar datos en nuestros estudios, o al recibir datos pre-existentes de archivos estadísticos, es probable que nos encontremos con un archivo .csv, donde cada fila tenga la respuesta de un participante o un país, y una columna represente una variable, concepto o pregunta. Queremos importar esto a R para manipular estos datos (renombrarlos, crear nuevas variables de las existentes, fusionar conjuntos de datos que tengan puntos en común) y generar posiblemente estadísticas que resuman la información, así como analizar y visualizar las tendencias halladas.</span>
<span id="cb189-194"><a href="#cb189-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-195"><a href="#cb189-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r importando archivos .csv}</span></span>
<span id="cb189-196"><a href="#cb189-196" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb189-197"><a href="#cb189-197" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb189-198"><a href="#cb189-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-199"><a href="#cb189-199" aria-hidden="true" tabindex="-1"></a><span class="co"># escribiendo un csv</span></span>
<span id="cb189-200"><a href="#cb189-200" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(mtcars, "mtcars.csv")</span></span>
<span id="cb189-201"><a href="#cb189-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-202"><a href="#cb189-202" aria-hidden="true" tabindex="-1"></a><span class="co"># load a csv file</span></span>
<span id="cb189-203"><a href="#cb189-203" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"mtcars.csv"</span>)</span>
<span id="cb189-204"><a href="#cb189-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-205"><a href="#cb189-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-206"><a href="#cb189-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-207"><a href="#cb189-207" aria-hidden="true" tabindex="-1"></a>Esta importación es sencilla también con Stata o SPSS usando el paquete <span class="in">`haven`</span>:</span>
<span id="cb189-208"><a href="#cb189-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-209"><a href="#cb189-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DTA y SAV}</span></span>
<span id="cb189-210"><a href="#cb189-210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb189-211"><a href="#cb189-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-212"><a href="#cb189-212" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">write_dta</span>(mtcars, <span class="st">"mtcars.dta"</span>)</span>
<span id="cb189-213"><a href="#cb189-213" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">"mtcars.dta"</span>)</span>
<span id="cb189-214"><a href="#cb189-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-215"><a href="#cb189-215" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">write_sav</span>(mtcars, <span class="st">"mtcars.sav"</span>)</span>
<span id="cb189-216"><a href="#cb189-216" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"mtcars.sav"</span>)</span>
<span id="cb189-217"><a href="#cb189-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-218"><a href="#cb189-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-219"><a href="#cb189-219" aria-hidden="true" tabindex="-1"></a>Una vez hayan importado los datos es probable que quieran echarle un vistazo a los datos, asegurarse que todo entró adecuadamente:</span>
<span id="cb189-220"><a href="#cb189-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-221"><a href="#cb189-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echando un vistazo}</span></span>
<span id="cb189-222"><a href="#cb189-222" aria-hidden="true" tabindex="-1"></a><span class="co">#mira los nombres de las variables</span></span>
<span id="cb189-223"><a href="#cb189-223" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span>
<span id="cb189-224"><a href="#cb189-224" aria-hidden="true" tabindex="-1"></a><span class="co">#recoge los datos básicos de las variables en el conjunto (e.g. observaciones, datos ausentes, mínimo, máximo, media)</span></span>
<span id="cb189-225"><a href="#cb189-225" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d)</span>
<span id="cb189-226"><a href="#cb189-226" aria-hidden="true" tabindex="-1"></a><span class="co">#las primeras filas</span></span>
<span id="cb189-227"><a href="#cb189-227" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb189-228"><a href="#cb189-228" aria-hidden="true" tabindex="-1"></a><span class="co">#las últimas filas</span></span>
<span id="cb189-229"><a href="#cb189-229" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(d)</span>
<span id="cb189-230"><a href="#cb189-230" aria-hidden="true" tabindex="-1"></a><span class="co">#los tipos de variable</span></span>
<span id="cb189-231"><a href="#cb189-231" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span>
<span id="cb189-232"><a href="#cb189-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-233"><a href="#cb189-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-234"><a href="#cb189-234" aria-hidden="true" tabindex="-1"></a>Recuerden que para datos pre-existentes en R o paquetes, pueden buscar más información sobre los datos al poner <span class="in">`?[nombredatos]`</span> en la consola. <span class="in">`mtcars`</span> es uno de estos, así que podríamos ir a verificar en la pestaña de ayuda sobre los datos y el significado de estos.</span>
<span id="cb189-235"><a href="#cb189-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-238"><a href="#cb189-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-239"><a href="#cb189-239" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(mtcars)</span>
<span id="cb189-240"><a href="#cb189-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-241"><a href="#cb189-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-242"><a href="#cb189-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tipos de datos</span></span>
<span id="cb189-243"><a href="#cb189-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-244"><a href="#cb189-244" aria-hidden="true" tabindex="-1"></a>Hay cuatro tipos de datos en R. Sabiendo de ellos podemos entender lsa limitaciones de análisis de cada uno, y también podrán entender mejor algunos errores que podrían recibir. Estos son:</span>
<span id="cb189-245"><a href="#cb189-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-246"><a href="#cb189-246" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Numéricos (números, enteros, dobles (aceptan los decimales))</span>
<span id="cb189-247"><a href="#cb189-247" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Caracterers (strings)</span>
<span id="cb189-248"><a href="#cb189-248" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Lógicos (C/F)</span>
<span id="cb189-249"><a href="#cb189-249" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Factores (niveles discretos; e.g., categorías)</span>
<span id="cb189-250"><a href="#cb189-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-251"><a href="#cb189-251" aria-hidden="true" tabindex="-1"></a>Si ponemos la función <span class="in">`str(d)`</span> notarán que cada variable tiene una asignatura de tipo. Pueden cambiar el tipo de datos, por ejemplo hacia categórico usando la función <span class="in">`as.factor()`</span>. Ejemplo:</span>
<span id="cb189-252"><a href="#cb189-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-255"><a href="#cb189-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-256"><a href="#cb189-256" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span>
<span id="cb189-257"><a href="#cb189-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-258"><a href="#cb189-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-261"><a href="#cb189-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-262"><a href="#cb189-262" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>am)</span>
<span id="cb189-263"><a href="#cb189-263" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d<span class="sc">$</span>am)</span>
<span id="cb189-264"><a href="#cb189-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-265"><a href="#cb189-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-266"><a href="#cb189-266" aria-hidden="true" tabindex="-1"></a>En estos datos <span class="in">`am`</span> nos informa si el vehículo usa transmisión automática (0) o manual (1). Estas son categorías en realidad, representadas por una variable dummy, pues es mejor reclasificarlas de ser números continuos a categorías: al usar <span class="in">`as.factor()`</span> le dijimos a R que <span class="in">`am`</span> era un factor. Puedes verificar manualmente el estado o transformación de una variable al usar <span class="in">`str(nombre_de_variable)`</span>.</span>
<span id="cb189-267"><a href="#cb189-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-268"><a href="#cb189-268" aria-hidden="true" tabindex="-1"></a><span class="fu">## El operador de accesso `$`</span></span>
<span id="cb189-269"><a href="#cb189-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-270"><a href="#cb189-270" aria-hidden="true" tabindex="-1"></a>A menudo queremos no entender todos los datos (pueden ser muchos) sino entender algunas variables en específico. Podemos usar un código que permite acceder a la variable dentro de un objeto: <span class="in">`datos$nombre_var`</span>--el conjunto de datos, un signo de peso o dólar, y el nombre de la variable. Por ejemplo, <span class="in">`d$cyl`</span> es decirle a R **"dentro del conjunto de datos `d`, la variable `cyl`"**. Es importante en este punto especificar el conjunto que queremos acceder, pues tenemos varias opciones.</span>
<span id="cb189-271"><a href="#cb189-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-272"><a href="#cb189-272" aria-hidden="true" tabindex="-1"></a><span class="fu">### Apegándonos de un conjunto de datos</span></span>
<span id="cb189-273"><a href="#cb189-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-274"><a href="#cb189-274" aria-hidden="true" tabindex="-1"></a>Es posible que quieran trabajar con sólo uno o mayormente uno de estos conjuntos de datos. Ahí podríamos usar la opción de <span class="in">`attach(datos)`</span> mientras operas con esos datos, y luego <span class="in">`detach()`</span> al terminar con ellos. En este caso, le decimos a R que asuma que al llamar la variable, nos referimos a los datos que 'pegamos' a la memoria.</span>
<span id="cb189-275"><a href="#cb189-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-276"><a href="#cb189-276" aria-hidden="true" tabindex="-1"></a>*Si bien esto puede ser conveniente, podría llevar a ciertos errores por olvido o por cambios en los datos, debe ser usado sin mucha frecuencia.*</span>
<span id="cb189-277"><a href="#cb189-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-278"><a href="#cb189-278" aria-hidden="true" tabindex="-1"></a>Aquí 'pegamos' ese conjunto de datos y hacemos una operación con la variable de automático o manual <span class="in">`am`</span>:</span>
<span id="cb189-279"><a href="#cb189-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-280"><a href="#cb189-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r df pegado}</span></span>
<span id="cb189-281"><a href="#cb189-281" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span>
<span id="cb189-282"><a href="#cb189-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-283"><a href="#cb189-283" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(am)</span>
<span id="cb189-284"><a href="#cb189-284" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(am)</span>
<span id="cb189-285"><a href="#cb189-285" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(am)</span>
<span id="cb189-286"><a href="#cb189-286" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(am)</span>
<span id="cb189-287"><a href="#cb189-287" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(am)</span>
<span id="cb189-288"><a href="#cb189-288" aria-hidden="true" tabindex="-1"></a>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(am)</span>
<span id="cb189-289"><a href="#cb189-289" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(am)</span>
<span id="cb189-290"><a href="#cb189-290" aria-hidden="true" tabindex="-1"></a><span class="co">#sd(am) #dará error: no se puede aplicar esto a valores categóricos</span></span>
<span id="cb189-291"><a href="#cb189-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-292"><a href="#cb189-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-293"><a href="#cb189-293" aria-hidden="true" tabindex="-1"></a>Si optaron por usar la función de <span class="in">`attach`</span>, ¡asegúrense de 'despegar' el conjunto de datos al terminar las operaciones que iban a usar!</span>
<span id="cb189-294"><a href="#cb189-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-295"><a href="#cb189-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r despegando el df}</span></span>
<span id="cb189-296"><a href="#cb189-296" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span>
<span id="cb189-297"><a href="#cb189-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-298"><a href="#cb189-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-299"><a href="#cb189-299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Verificando las variables</span></span>
<span id="cb189-300"><a href="#cb189-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-301"><a href="#cb189-301" aria-hidden="true" tabindex="-1"></a>Ahora que podemos acceder a las variables, podemos explorarlas con varias funciones existentes en R y paquetes adicionales. También podríamos crear nuestras propias funciones. Abajo algunas:</span>
<span id="cb189-302"><a href="#cb189-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-305"><a href="#cb189-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-306"><a href="#cb189-306" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(d<span class="sc">$</span>mpg, d<span class="sc">$</span>gear, mean) <span class="co">#aplica la función de promedio a la variable de mpg para verlos según la cantidad de cambios--3, 4 o 5</span></span>
<span id="cb189-307"><a href="#cb189-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-308"><a href="#cb189-308" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(d, mean) <span class="co"># promedia cada variable del conjunto en lista o vector</span></span>
<span id="cb189-309"><a href="#cb189-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-310"><a href="#cb189-310" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d<span class="sc">$</span>mpg) <span class="co">#estadísticas resumidas básicas</span></span>
<span id="cb189-311"><a href="#cb189-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-312"><a href="#cb189-312" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(d<span class="sc">$</span>carb, d<span class="sc">$</span>am) <span class="co">#tabla de frecuencias</span></span>
<span id="cb189-313"><a href="#cb189-313" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(d<span class="sc">$</span>carb, d<span class="sc">$</span>am, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">'núm. de carburadores'</span>,<span class="st">'transmisión'</span>))) <span class="co">#añade información adicional a la tabla</span></span>
<span id="cb189-314"><a href="#cb189-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-315"><a href="#cb189-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando la distribución</span></span>
<span id="cb189-316"><a href="#cb189-316" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d<span class="sc">$</span>wt, <span class="at">col =</span> <span class="st">'red3'</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">main =</span> <span class="st">'Distribución del peso'</span>)</span>
<span id="cb189-317"><a href="#cb189-317" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>wt, <span class="at">ylab =</span> <span class="st">'Peso (en miles)'</span>)</span>
<span id="cb189-318"><a href="#cb189-318" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>wt<span class="sc">~</span>d<span class="sc">$</span>mpg,<span class="at">xlab=</span><span class="st">"Millas por galón"</span>,<span class="at">ylab=</span><span class="st">'Peso (en miles)'</span>)</span>
<span id="cb189-319"><a href="#cb189-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-320"><a href="#cb189-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-321"><a href="#cb189-321" aria-hidden="true" tabindex="-1"></a>Nota que para estas funciones lo que se *requiere* en realidad es el nombre de la variable como argumento. ¿Qué creen signifiquen las opciones <span class="in">`col =`</span>, <span class="in">`xlab =`</span>, <span class="in">`main =`</span>, y <span class="in">`ylab =`</span>?</span>
<span id="cb189-322"><a href="#cb189-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-323"><a href="#cb189-323" aria-hidden="true" tabindex="-1"></a>Podríamos también agrupar la información como ocurre en estos casos abajo del paquete <span class="in">`psych`</span>.</span>
<span id="cb189-324"><a href="#cb189-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-325"><a href="#cb189-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r psych, paquete que añade más descripción}</span></span>
<span id="cb189-326"><a href="#cb189-326" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("psych")</span></span>
<span id="cb189-327"><a href="#cb189-327" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb189-328"><a href="#cb189-328" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(d<span class="sc">$</span>hp) <span class="co"># la función "describe" viene en el paquete de psych; da datos adicionales</span></span>
<span id="cb189-329"><a href="#cb189-329" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(d<span class="sc">$</span>mpg, d<span class="sc">$</span>am) <span class="co"># del paquete "psych"</span></span>
<span id="cb189-330"><a href="#cb189-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-331"><a href="#cb189-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-332"><a href="#cb189-332" aria-hidden="true" tabindex="-1"></a>Una forma más complicada pero útil de verificar estadísticas es la función <span class="in">`xtabs()`</span>, es decir tabulación cruzada. El código pide una fórmula que contraste las variables. El código es un poco más complicado pero se puede interpretar como "la suma de <span class="in">`mpg`</span>, para cada grupo de <span class="in">`cyl`</span> y <span class="in">`am`</span>". Ya que <span class="in">`cyl`</span> tiene tres grupos y <span class="in">`am`</span> tiene dos grupos, <span class="in">`xtabs()`</span> devuelve una tabla de seis celdas con las sumas de <span class="in">`mpg`</span> para cada uno de estos grupos; así podríamos por ejemplo verificar como cambian las medias dadas ciertas categorías. Noten que hemos usado, sin <span class="in">`attach()`</span> el nombre de las variables, ya que le dijimos a la función que se enfocara en las variables dentro del objeto definido en la opción <span class="in">`data = conjunto_de_datos`</span> (aquí, *data* = d).</span>
<span id="cb189-333"><a href="#cb189-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-336"><a href="#cb189-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-337"><a href="#cb189-337" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span>
<span id="cb189-338"><a href="#cb189-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-339"><a href="#cb189-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-340"><a href="#cb189-340" aria-hidden="true" tabindex="-1"></a>Si queríamos el promedio de millas por galón por categoría hacemos lo siguiente:</span>
<span id="cb189-341"><a href="#cb189-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-344"><a href="#cb189-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-345"><a href="#cb189-345" aria-hidden="true" tabindex="-1"></a><span class="co"># Sumamos mpg por categorías de cyl y am</span></span>
<span id="cb189-346"><a href="#cb189-346" aria-hidden="true" tabindex="-1"></a>suma_mpg <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span>
<span id="cb189-347"><a href="#cb189-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-348"><a href="#cb189-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Sacamos la cantidad de observaciones por categorías de cyl y am obviando el lado izquierdo de la fórmula</span></span>
<span id="cb189-349"><a href="#cb189-349" aria-hidden="true" tabindex="-1"></a>cantidad <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> cyl <span class="sc">+</span> am, <span class="at">data =</span> d)</span>
<span id="cb189-350"><a href="#cb189-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-351"><a href="#cb189-351" aria-hidden="true" tabindex="-1"></a><span class="co"># Media de mpg por categorías de cyl y am</span></span>
<span id="cb189-352"><a href="#cb189-352" aria-hidden="true" tabindex="-1"></a>media_mpg <span class="ot">&lt;-</span> suma_mpg <span class="sc">/</span> cantidad</span>
<span id="cb189-353"><a href="#cb189-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-354"><a href="#cb189-354" aria-hidden="true" tabindex="-1"></a>media_mpg</span>
<span id="cb189-355"><a href="#cb189-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-356"><a href="#cb189-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-357"><a href="#cb189-357" aria-hidden="true" tabindex="-1"></a>En este caso hemos obtenido la media de millas por galón según la cantidad de cilindros del vehículo, y si la transmisión era manual o automática.</span>
<span id="cb189-358"><a href="#cb189-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-359"><a href="#cb189-359" aria-hidden="true" tabindex="-1"></a><span class="fu"># Entendiendo y manipulando datos: Tidyverse</span></span>
<span id="cb189-360"><a href="#cb189-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-361"><a href="#cb189-361" aria-hidden="true" tabindex="-1"></a>Si bien podríamos usar esta información previa para entender los datos. Digamos que queremos saber qué carro es el mejor en estos datos en cuestión de millas por galón. Podríamos hacer:</span>
<span id="cb189-362"><a href="#cb189-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-363"><a href="#cb189-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Encontrando máximos y mínimos}</span></span>
<span id="cb189-364"><a href="#cb189-364" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb189-365"><a href="#cb189-365" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mpg"</span>)</span>
<span id="cb189-366"><a href="#cb189-366" aria-hidden="true" tabindex="-1"></a>?mpg</span>
<span id="cb189-367"><a href="#cb189-367" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpg)</span>
<span id="cb189-368"><a href="#cb189-368" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mpg<span class="sc">$</span>hwy) <span class="co">#sin embargo esto no nos lleva a mucha más información</span></span>
<span id="cb189-369"><a href="#cb189-369" aria-hidden="true" tabindex="-1"></a>i_max<span class="ot">&lt;-</span><span class="fu">which.max</span>(mpg<span class="sc">$</span>hwy)</span>
<span id="cb189-370"><a href="#cb189-370" aria-hidden="true" tabindex="-1"></a>mpg<span class="sc">$</span>model[i_max]</span>
<span id="cb189-371"><a href="#cb189-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-372"><a href="#cb189-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-373"><a href="#cb189-373" aria-hidden="true" tabindex="-1"></a>El vehículo con mejor millaje por galón fue el Jetta. Igualmente si trabajamos datos de criminalidad en EEUU, podríamos tener</span>
<span id="cb189-374"><a href="#cb189-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-377"><a href="#cb189-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-378"><a href="#cb189-378" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb189-379"><a href="#cb189-379" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(murders)</span>
<span id="cb189-380"><a href="#cb189-380" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(murders)</span>
<span id="cb189-381"><a href="#cb189-381" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(murders<span class="sc">$</span>total) <span class="co">#queremos igual aquí saber el estado que menos tuvo</span></span>
<span id="cb189-382"><a href="#cb189-382" aria-hidden="true" tabindex="-1"></a>i_min<span class="ot">&lt;-</span><span class="fu">which.min</span>(murders<span class="sc">$</span>total)</span>
<span id="cb189-383"><a href="#cb189-383" aria-hidden="true" tabindex="-1"></a>murders<span class="sc">$</span>state[i_min]</span>
<span id="cb189-384"><a href="#cb189-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-385"><a href="#cb189-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-386"><a href="#cb189-386" aria-hidden="true" tabindex="-1"></a>Y tendríamos este resultado, con Vermont como el que menos asesinatos de arma de fuego registrara en 2010.</span>
<span id="cb189-387"><a href="#cb189-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-388"><a href="#cb189-388" aria-hidden="true" tabindex="-1"></a>Sin embargo esto no es suficiente quizás para todo lo que queremos hacer y se ve demasiado laborioso o largo en relación a lo que obtenemos. En el caso de los datos de asesinatos por arma de fuego, hemos buscado el estado con menos asesinatos, y vemos que hay un rango enorme entre ése y el mayor, pero ¿estamos comparando chinas con chinas?</span>
<span id="cb189-389"><a href="#cb189-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-390"><a href="#cb189-390" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modificando conjuntos de datos: creando una variable</span></span>
<span id="cb189-391"><a href="#cb189-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-392"><a href="#cb189-392" aria-hidden="true" tabindex="-1"></a>Podríamos crear una tasa de asesinatos para este último conjunto de datos, con la información ya suministrada.</span>
<span id="cb189-393"><a href="#cb189-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-394"><a href="#cb189-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Crear una variable}</span></span>
<span id="cb189-395"><a href="#cb189-395" aria-hidden="true" tabindex="-1"></a>murders<span class="sc">$</span>tasa_100k<span class="ot">&lt;-</span>murders<span class="sc">$</span>total<span class="sc">/</span>murders<span class="sc">$</span>population <span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb189-396"><a href="#cb189-396" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(murders)</span>
<span id="cb189-397"><a href="#cb189-397" aria-hidden="true" tabindex="-1"></a><span class="co">#en tidyverse esto se puede hacer con la función mutate()</span></span>
<span id="cb189-398"><a href="#cb189-398" aria-hidden="true" tabindex="-1"></a>murders<span class="ot">&lt;-</span><span class="fu">mutate</span>(murders,<span class="at">tasa=</span>total<span class="sc">/</span>population<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb189-399"><a href="#cb189-399" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(murders)</span>
<span id="cb189-400"><a href="#cb189-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-401"><a href="#cb189-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-402"><a href="#cb189-402" aria-hidden="true" tabindex="-1"></a>Digamos que ahora queremos ver una lista más informativa e intuitiva de los datos; por ejemplo, qué otros carros figuran con buen millaje por galón:</span>
<span id="cb189-403"><a href="#cb189-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-406"><a href="#cb189-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-407"><a href="#cb189-407" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(mpg, hwy<span class="sc">&gt;=</span><span class="dv">35</span>) </span>
<span id="cb189-408"><a href="#cb189-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-409"><a href="#cb189-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-410"><a href="#cb189-410" aria-hidden="true" tabindex="-1"></a>En este caso hemos seleccionado las filas para visualizar que tienen millaje por galón superior a 35: hemos creado un **subconjunto**.</span>
<span id="cb189-411"><a href="#cb189-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-412"><a href="#cb189-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## El operador pipe `%&gt;%` o `|&gt;`</span></span>
<span id="cb189-413"><a href="#cb189-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-414"><a href="#cb189-414" aria-hidden="true" tabindex="-1"></a>Digamos que realmente queremos reducir la cantidad de columnas en las que queremos enfocarnos, pues los datos de <span class="in">`mpg`</span> tienen demasiadas. Podríamos crear otro subconjunto:</span>
<span id="cb189-415"><a href="#cb189-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-416"><a href="#cb189-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select}</span></span>
<span id="cb189-417"><a href="#cb189-417" aria-hidden="true" tabindex="-1"></a>tabla_nueva_mpg<span class="ot">&lt;-</span><span class="fu">select</span>(mpg,model,year,cty,hwy)</span>
<span id="cb189-418"><a href="#cb189-418" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tabla_nueva_mpg, hwy<span class="sc">&gt;=</span><span class="dv">35</span>) </span>
<span id="cb189-419"><a href="#cb189-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-420"><a href="#cb189-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-421"><a href="#cb189-421" aria-hidden="true" tabindex="-1"></a>Y nos quedamos con cuatro columnas dándonos información puntual si esto era lo que nos interesaba. Sin embargo, podríamos evitarnos la creación de objetos intermedios al usar la función que canaliza los datos en secuencia funcional así:</span>
<span id="cb189-422"><a href="#cb189-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-425"><a href="#cb189-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-426"><a href="#cb189-426" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> <span class="fu">select</span>(model,year,cty,hwy) <span class="sc">|&gt;</span> <span class="fu">filter</span>(hwy<span class="sc">&gt;=</span><span class="dv">35</span>)</span>
<span id="cb189-427"><a href="#cb189-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-428"><a href="#cb189-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-429"><a href="#cb189-429" aria-hidden="true" tabindex="-1"></a>*Vale la pena señalar que el* pipe *funcionará bien con las funciones donde el primer argumento sean los datos de entrada, que canalizamos. Las funciones de tidyr y dplyr operan así y se acoplan al* pipe*.*</span>
<span id="cb189-430"><a href="#cb189-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-431"><a href="#cb189-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resumiendo datos explorativamente con Tidy</span></span>
<span id="cb189-432"><a href="#cb189-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-433"><a href="#cb189-433" aria-hidden="true" tabindex="-1"></a>En esta sección cubriremos dos funciones de tidyverse, en dplyr, <span class="in">`summarise`</span> y <span class="in">`group_by`</span>. La primera, <span class="in">`summarise`</span>, ofrece el cálculo de estadísticas de resumen con un código legible e intuitivo. El segundo agrupa y resume los datos por categorías inherente en las variables existentes. Por ejemplo, quizás quisiéramos calcular el promedio y desviación estándar de los vehículos en los datos de millaje por galón, pero queremos agruparlos por fabricante, o tipo de transmisión, o cualquier otro tipo de variable:</span>
<span id="cb189-434"><a href="#cb189-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-437"><a href="#cb189-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-438"><a href="#cb189-438" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb189-439"><a href="#cb189-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb189-440"><a href="#cb189-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mpg_grupal=</span><span class="fu">mean</span>(hwy),</span>
<span id="cb189-441"><a href="#cb189-441" aria-hidden="true" tabindex="-1"></a>            <span class="at">ds_grupal=</span><span class="fu">sd</span>(hwy)) <span class="co">#por fabricador</span></span>
<span id="cb189-442"><a href="#cb189-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-443"><a href="#cb189-443" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb189-444"><a href="#cb189-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trans) <span class="sc">|&gt;</span></span>
<span id="cb189-445"><a href="#cb189-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mpg_grupal=</span><span class="fu">mean</span>(hwy),</span>
<span id="cb189-446"><a href="#cb189-446" aria-hidden="true" tabindex="-1"></a>            <span class="at">ds_grupal=</span><span class="fu">sd</span>(hwy)) <span class="co">#por año de manufactura</span></span>
<span id="cb189-447"><a href="#cb189-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-448"><a href="#cb189-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-449"><a href="#cb189-449" aria-hidden="true" tabindex="-1"></a>Podemos también aplicar una función creada previamente:</span>
<span id="cb189-450"><a href="#cb189-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-453"><a href="#cb189-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-454"><a href="#cb189-454" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(mediana_mín_máx(hwy))</span>
<span id="cb189-455"><a href="#cb189-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-456"><a href="#cb189-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-457"><a href="#cb189-457" aria-hidden="true" tabindex="-1"></a>Digamos que queremos obtener las tasas medias de regiones específicas en los EEUU. En este caso entra más complicación pero en Tidyverse podemos usar tanto el pipe <span class="in">`%&gt;%`</span> como la <span class="in">`%in%`</span> (el %in% es una función que busca parear la entrada de un valor mapeado en otro):</span>
<span id="cb189-458"><a href="#cb189-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-461"><a href="#cb189-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-462"><a href="#cb189-462" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">%&gt;%</span></span>
<span id="cb189-463"><a href="#cb189-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb189-464"><a href="#cb189-464" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ME"</span>, <span class="st">"NH"</span>, <span class="st">"VT"</span>, <span class="st">"MA"</span>, <span class="st">"RI"</span>, <span class="st">"CT"</span>) <span class="sc">~</span> <span class="st">"Nueva Inglaterra"</span>,</span>
<span id="cb189-465"><a href="#cb189-465" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span>) <span class="sc">~</span> <span class="st">"Costa del Pacífico"</span>,</span>
<span id="cb189-466"><a href="#cb189-466" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>,</span>
<span id="cb189-467"><a href="#cb189-467" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otras regiones"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb189-468"><a href="#cb189-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb189-469"><a href="#cb189-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa_100k =</span> <span class="fu">sum</span>(total)<span class="sc">/</span> <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb189-470"><a href="#cb189-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-471"><a href="#cb189-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-472"><a href="#cb189-472" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualización de datos: porqués</span></span>
<span id="cb189-473"><a href="#cb189-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-474"><a href="#cb189-474" aria-hidden="true" tabindex="-1"></a>Ver números y cadenas de caracteres que forman un conjunto de datos puede ser interesante, o no, pero normalmente no tiene tanta utilidad. Por ejemplo:</span>
<span id="cb189-475"><a href="#cb189-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-476"><a href="#cb189-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Cargando datos de Wooldridge}</span></span>
<span id="cb189-477"><a href="#cb189-477" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb189-478"><a href="#cb189-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-479"><a href="#cb189-479" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wage1)</span>
<span id="cb189-480"><a href="#cb189-480" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wage1)</span>
<span id="cb189-481"><a href="#cb189-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-482"><a href="#cb189-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-483"><a href="#cb189-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-484"><a href="#cb189-484" aria-hidden="true" tabindex="-1"></a>¿Qué aprendemos de ver estos datos así? ¿Podemos rápidamente determinar a si años de educación se traducen a mayores ingresos? ¿Podemos determinar si afecta en algo la relación marital? Para muchos humanos, es difícil extraer información con meramente mirar a números sin contexto adicional. Pero podríamos ver algo en este gráfico</span>
<span id="cb189-485"><a href="#cb189-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-486"><a href="#cb189-486" aria-hidden="true" tabindex="-1"></a><span class="al">![Meta 1.ª: datos de ingreso, que continuaremos al abundar en modelos inferenciales el miércoles que viene.](Relación.png)</span></span>
<span id="cb189-487"><a href="#cb189-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-488"><a href="#cb189-488" aria-hidden="true" tabindex="-1"></a>Lo mismo podríamos hacer con los datos que trabajamos la semana pasada de homicidios con armas de fuego en EEUU:</span>
<span id="cb189-489"><a href="#cb189-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-492"><a href="#cb189-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-493"><a href="#cb189-493" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb189-494"><a href="#cb189-494" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb189-495"><a href="#cb189-495" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"murders"</span>)</span>
<span id="cb189-496"><a href="#cb189-496" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(murders)</span>
<span id="cb189-497"><a href="#cb189-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-498"><a href="#cb189-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-499"><a href="#cb189-499" aria-hidden="true" tabindex="-1"></a>No podemos determinar con facilidad a qué estado le toca la población más grande o pequeña, y si existe alguna relación entre el tamaño de población y el total de asesinatos, o de cómo varían las tasas de asesinatos por regiones de estados en la federación estadounidense. Sin embargo, eso puede responderse sin muchas palabras con el próximo gráfico.</span>
<span id="cb189-500"><a href="#cb189-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-501"><a href="#cb189-501" aria-hidden="true" tabindex="-1"></a><span class="al">![Gráfico de la meta 2.ª](Meta.png)</span></span>
<span id="cb189-502"><a href="#cb189-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-503"><a href="#cb189-503" aria-hidden="true" tabindex="-1"></a>Una imagen vale más que mil palabras dice el dicho. Sin adentrarnos a la inferencia estadística (que cubriremos en la tercera semana de esta secuencia de talleres), hemos podido comunicar relaciones y hallazgos en datos. A veces puede ser este ejercicio uno tan convincente que no requiera análisis subsiguientes.</span>
<span id="cb189-504"><a href="#cb189-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-505"><a href="#cb189-505" aria-hidden="true" tabindex="-1"></a>Vivimos en una era de creciente disponibilidad de conjuntos de datos informativos y de herramientas de software, con lo cual el uso de visualizaciones ha aumentado en diversos espacios: académicos, gubernamentales, organizaciones sociales, prensa, e industrias varias.</span>
<span id="cb189-506"><a href="#cb189-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-507"><a href="#cb189-507" aria-hidden="true" tabindex="-1"></a>En R, una de las principales maneras con la que trabajaremos estos análisis visuales es de la mano de <span class="in">`ggplot2`</span>, así como con otros paquetes que ayudan a procesar esta información. Si bien existen otros métodos de graficar en R y otros programas, la preferencia de este taller es utilizar el sistema de procesamiento que ofrece <span class="in">`tidyverse`</span>, con <span class="in">`ggplot2`</span> incluido.</span>
<span id="cb189-508"><a href="#cb189-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-509"><a href="#cb189-509" aria-hidden="true" tabindex="-1"></a>Esta es una secuencia de tres semanas, y en esta lección continuamos con lo aprendido la semana anterior, donde terminamos con visualizaciones sencillas y con el uso de <span class="in">`tidyverse`</span> para manejar datos. Tenemos la meta hoy de que al culminar las segundas dos horas de esta secuencia podamos:</span>
<span id="cb189-510"><a href="#cb189-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-511"><a href="#cb189-511" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Entender cómo usar la gramática de gráficas</span>
<span id="cb189-512"><a href="#cb189-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-513"><a href="#cb189-513" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Entender cómo usar <span class="in">`ggplot2`</span>, continuando con lo aprendido de <span class="in">`tidyverse`</span> de la semana pasada.</span>
<span id="cb189-514"><a href="#cb189-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-515"><a href="#cb189-515" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Entender cómo utilizar en varias maneras <span class="in">`tidycensus`</span> para generar mapas.</span>
<span id="cb189-516"><a href="#cb189-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-517"><a href="#cb189-517" aria-hidden="true" tabindex="-1"></a>En la próxima sesión, del 10 de octubre, entraremos más en *wrangling* de datos, así como en la inferencia estadística, con introducciones en R sobre modelos lineales, jerárquicos y longitudinales, así como sus diagnósticos posteriores. </span>
<span id="cb189-518"><a href="#cb189-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-519"><a href="#cb189-519" aria-hidden="true" tabindex="-1"></a><span class="fu"># ggplot2</span></span>
<span id="cb189-520"><a href="#cb189-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-521"><a href="#cb189-521" aria-hidden="true" tabindex="-1"></a>R ofrece varias opciones para graficar, siendo útiles las capacidades incluidas en su instalación básica. Además, existen paquetes como <span class="in">`grid`</span>, que permite un control preciso de los elementos gráficos, y <span class="in">`lattice`</span>, que facilita la creación de gráficos multivariados y en paneles o facetas. Sin embargo, en este taller (y en los libros de referencia usados y descritos arriba) se ha optado por usar <span class="in">`ggplot2`</span>, ya que permite a los principiantes crear gráficos complejos y estéticos mediante una sintaxis intuitiva y fácil de recordar, dividiendo los gráficos en componentes básicos.</span>
<span id="cb189-522"><a href="#cb189-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-523"><a href="#cb189-523" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> destaca por su uso de una <span class="co">[</span><span class="ot">*g*</span><span class="co">]</span>{.underline}*ramática de [g]{.underline}ráficos* – de donde vienen las primeras dos g – que simplifica el proceso de creación de gráficos. Al aprender unos pocos componentes esenciales de esta gramática, los usuarios pueden generar una amplia variedad de gráficos con facilidad. Además, su comportamiento por defecto está diseñado para producir resultados agradables y funcionales con código conciso y legible, lo que facilita su uso por principiantes. Como factor limitante está el que está diseñado para trabajar con tablas de formato *tidy* (con filas con observaciones y columnas conteniendo variables), pero un número sustancial de conjuntos de datos se trabajan en ese formato, o pueden convertirse a ese formato.</span>
<span id="cb189-524"><a href="#cb189-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-525"><a href="#cb189-525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Componentes de un gráfico</span></span>
<span id="cb189-526"><a href="#cb189-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-527"><a href="#cb189-527" aria-hidden="true" tabindex="-1"></a>Hoy construiremos varios tipos de gráficos como los que vimos arriba, así como mapas informativos. Antes que todo eso, vale señalar que los gráficos se dividen en tres componentes principales. Usaré otro gráfico que creara en 2020 durante la pandemia del Coronavirus para ejemplificar estos componentes.</span>
<span id="cb189-528"><a href="#cb189-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-529"><a href="#cb189-529" aria-hidden="true" tabindex="-1"></a><span class="al">![Datos para ejemplificar](Covid.png)</span></span>
<span id="cb189-530"><a href="#cb189-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-531"><a href="#cb189-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Datos**:</span>
<span id="cb189-532"><a href="#cb189-532" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estoy pasando al gráfico un conjunto de datos que corté sobre fatalidad de casos de COVID-19 hasta el 31 de julio de 2020 (los datos continúan hasta 2023).</span>
<span id="cb189-533"><a href="#cb189-533" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Este es el componente de *datos* del gráfico.</span>
<span id="cb189-534"><a href="#cb189-534" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Geometrías**:</span>
<span id="cb189-535"><a href="#cb189-535" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>El gráfico es uno de líneas, útil para varias series de tiempo. Este componente es una *geometría*. Otras geometrías posibles son gráficos de dispersión, histogramas, diagramas de barras, densidades suavizadas, y diagrama de cajas, entre otros.</span>
<span id="cb189-536"><a href="#cb189-536" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Mapeo estético**:</span>
<span id="cb189-537"><a href="#cb189-537" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>El gráfico usa señales visuales para representar en el lienzo vacío con capas distintos tipos de información provista en el conjunto de datos:</span>
<span id="cb189-538"><a href="#cb189-538" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Posiciones en el eje de x (tiempo)</span>
<span id="cb189-539"><a href="#cb189-539" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Posiciones en el eje de y (tasas de mortandad observadas)</span>
<span id="cb189-540"><a href="#cb189-540" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Color (asignado por país)</span>
<span id="cb189-541"><a href="#cb189-541" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Cada línea representa la información de un país para una serie de fechas. Estos se aclaran con una etiqueta para aclararnos esa relación de línea-color-país.</span>
<span id="cb189-542"><a href="#cb189-542" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>El *mapeo estético* depende de la geometría utilizada.</span>
<span id="cb189-543"><a href="#cb189-543" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Observaciones adicionales**:\</span>
<span id="cb189-544"><a href="#cb189-544" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ejes *x* e *y* definidos por el rango de los datos y ambos en escalas logarítmicas.</span>
<span id="cb189-545"><a href="#cb189-545" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>El gráfico incluye etiquetas, un título, etiquetas de variables, nota al calce, y el tema utilizado es uno solarizado que pareciera no muy distante al utilizado por el periódico especializado "The Financial Times".</span>
<span id="cb189-546"><a href="#cb189-546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Volveremos luego a estos datos para construir esta imagen si nos da tiempo en el taller, y si no, tendrán disponible el cómo hacerlo para referencia.</span>
<span id="cb189-547"><a href="#cb189-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-548"><a href="#cb189-548" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lienzo vacío y capas</span></span>
<span id="cb189-549"><a href="#cb189-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-550"><a href="#cb189-550" aria-hidden="true" tabindex="-1"></a>Manteniéndonos cerca de los datos utilizados en la semana pasada, construiremos por ***capas*** la información que va en el gráfico.</span>
<span id="cb189-551"><a href="#cb189-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-552"><a href="#cb189-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Un lienzo en blanco}</span></span>
<span id="cb189-553"><a href="#cb189-553" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span> <span class="fu">ggplot</span>()</span>
<span id="cb189-554"><a href="#cb189-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-555"><a href="#cb189-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-556"><a href="#cb189-556" aria-hidden="true" tabindex="-1"></a>El primer paso de crear un gráfico de ggplot es asignar los datos a un lienzo vacío. Esto no significa poblar el lienzo con esos datos, sino pasarle al programa la información inicial, como un pintor que selecciona el tema que usará para la pintura que visualiza en su mente. Esto lo hicimos al pasar el *pipe* (<span class="in">`|&gt;`</span> o <span class="in">`|&gt;`</span>) los datos a ggplot, y lo que ocurrió fue que al no darle más información (capas, como la pintura en un lienzo), nos quedó un recuadro gris enmarcado por un borde blanco.</span>
<span id="cb189-557"><a href="#cb189-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-558"><a href="#cb189-558" aria-hidden="true" tabindex="-1"></a>En ggplot, la información entonces se suministra al lienzo por capas, y se le pueden añadir adicionales. Esto tomará la forma de código siguiente:</span>
<span id="cb189-559"><a href="#cb189-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-560"><a href="#cb189-560" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> DATOS <span class="sc">\|\&gt;</span> ggplot() + CAPA 1 + </span>
<span id="cb189-561"><a href="#cb189-561" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> CAPA 2 + ... + CAPA N</span>
<span id="cb189-562"><a href="#cb189-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-563"><a href="#cb189-563" aria-hidden="true" tabindex="-1"></a>Usualmente, la primera capa que añadimos define la geometría. Si queremos hacer un diagrama de dispersión, ¿qué geometría deberíamos utilizar?</span>
<span id="cb189-564"><a href="#cb189-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-565"><a href="#cb189-565" aria-hidden="true" tabindex="-1"></a>Si vemos la hoja de referencia (en la carpeta del taller 2, o accesible en esta página: <span class="ot">&lt;https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf&gt;</span>), vemos que la función utilizada para crear gráficos con esta geometría puntillista es <span class="in">`geom_point`</span>.</span>
<span id="cb189-566"><a href="#cb189-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-567"><a href="#cb189-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo una geometría}</span></span>
<span id="cb189-568"><a href="#cb189-568" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span></span>
<span id="cb189-569"><a href="#cb189-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb189-570"><a href="#cb189-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total))</span>
<span id="cb189-571"><a href="#cb189-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-572"><a href="#cb189-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-573"><a href="#cb189-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-574"><a href="#cb189-574" aria-hidden="true" tabindex="-1"></a>En este caso ya hemos dado un paso adicional y añadido una primera capa en esta obra: le indicamos que queremos una capa que tenga una geometría de puntos, y un mapeo estético que toma las coordenadas en un plano cartesiano donde el eje de equis queda definido como <span class="in">`population/10^6`</span>, la población de los estados o Wáshington D.C., en millones; el eje de ye queda definido entonces como el total de asesinatos con armas de fuego. En el mapeo estético entonces los puntos quedan asignados a esas coordenadas. De esta manera, las distancias entre puntos, así como otras características que queramos añadir, quedan expresadas. Esto se da a través de la función <span class="in">`aes`</span>. Esta será de las funciones que más usen al graficar.</span>
<span id="cb189-575"><a href="#cb189-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-576"><a href="#cb189-576" aria-hidden="true" tabindex="-1"></a>Noten que hasta ahora hemos trabajado este lienzo sin guardarlo como objeto. Si bien esto puede funcionar bien, es posible que queramos guardar nuestro progreso y seguir añadiendo capas adicionales. En este caso, al ejecutar el comando y guardarlo en objeto, el programa no nos dará automáticamente una actualización del gráfico; tendremos que llamar al objeto para que aparezca:</span>
<span id="cb189-577"><a href="#cb189-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-580"><a href="#cb189-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-581"><a href="#cb189-581" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb189-582"><a href="#cb189-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb189-583"><a href="#cb189-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total),<span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb189-584"><a href="#cb189-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-585"><a href="#cb189-585" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb189-586"><a href="#cb189-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-587"><a href="#cb189-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-588"><a href="#cb189-588" aria-hidden="true" tabindex="-1"></a>Tenemos entonces nuestro gráfico de dispersión inicial. Quizás no es tan informativo pero vemos una serie de puntos con el mapeo estético inicial. Noten que podríamos quitar la <span class="in">`x=`</span> y la <span class="in">`y=`</span> y no pasaría nada, ya que en ausencia de esta especificación, el programa entiende por defecto que lo primero que se le asigna es la información del eje horizontal, y en segundo orden el vertical:</span>
<span id="cb189-589"><a href="#cb189-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-590"><a href="#cb189-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo etiquetas}</span></span>
<span id="cb189-591"><a href="#cb189-591" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span></span>
<span id="cb189-592"><a href="#cb189-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total, <span class="at">label =</span> abb))</span>
<span id="cb189-593"><a href="#cb189-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-594"><a href="#cb189-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-595"><a href="#cb189-595" aria-hidden="true" tabindex="-1"></a>Aquí he añadido una geometría nueva: texto. Hay dos geometrías para esto, <span class="in">`geom_label`</span> y <span class="in">`geom_text`</span>, uno con el texto enmarcado en un recuadro y el segundo sin ello. Ya que cada punto (cada jurisdicción que es realmente parte de los Estados Unidos de América en este caso) tiene una etiqueta, necesitamos un mapeo estético para hacer la conexión entre los puntos y las etiquetas, así que se le asignó el mismo tal que el texto cayera exactamente en la misma coordenada que el punto. Pero esto se puede corregir:</span>
<span id="cb189-596"><a href="#cb189-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-597"><a href="#cb189-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Empujando etiquetas en el eje}</span></span>
<span id="cb189-598"><a href="#cb189-598" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span></span>
<span id="cb189-599"><a href="#cb189-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total, <span class="at">label =</span> abb),<span class="at">nudge_x =</span> <span class="fl">1.5</span>) </span>
<span id="cb189-600"><a href="#cb189-600" aria-hidden="true" tabindex="-1"></a><span class="co">#nudge_y desplazaría el texto en el eje de y</span></span>
<span id="cb189-601"><a href="#cb189-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-602"><a href="#cb189-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-603"><a href="#cb189-603" aria-hidden="true" tabindex="-1"></a>En este caso hemos empujado a través del eje de equis la etiqueta de texto con un valor numérico de 1.5. Valores mayores aumentarían la distancia del texto y el punto, mientras que menores harían lo contrario.</span>
<span id="cb189-604"><a href="#cb189-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-605"><a href="#cb189-605" aria-hidden="true" tabindex="-1"></a>Ahora podremos seguir con una complicación en el mapeo estético: queremos añadir una capa de color al lienzo que represente regiones de estas jurisdicciones. Esto se hace al añadir la opción de <span class="in">`colour`</span> y dándole una variable, en este caso <span class="in">`region`</span>.</span>
<span id="cb189-606"><a href="#cb189-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-607"><a href="#cb189-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo color}</span></span>
<span id="cb189-608"><a href="#cb189-608" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico base con puntos coloreados por región</span></span>
<span id="cb189-609"><a href="#cb189-609" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> murders <span class="sc">|&gt;</span></span>
<span id="cb189-610"><a href="#cb189-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb189-611"><a href="#cb189-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">colour =</span> region), <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb189-612"><a href="#cb189-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-613"><a href="#cb189-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico</span></span>
<span id="cb189-614"><a href="#cb189-614" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb189-615"><a href="#cb189-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-616"><a href="#cb189-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-617"><a href="#cb189-617" aria-hidden="true" tabindex="-1"></a>Ahora paso nuevamente a añadir etiquetas abreviadas, con el color por región.</span>
<span id="cb189-618"><a href="#cb189-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-619"><a href="#cb189-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo nuevamente etiquetas de abreviación jurisdiccional}</span></span>
<span id="cb189-620"><a href="#cb189-620" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir etiquetas desplazadas en el eje x (con color por región)</span></span>
<span id="cb189-621"><a href="#cb189-621" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>p <span class="sc">+</span> </span>
<span id="cb189-622"><a href="#cb189-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label =</span> abb, <span class="at">colour =</span> region), <span class="at">nudge_x =</span> <span class="fl">1.5</span>)</span>
<span id="cb189-623"><a href="#cb189-623" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb189-624"><a href="#cb189-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-625"><a href="#cb189-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-626"><a href="#cb189-626" aria-hidden="true" tabindex="-1"></a>Y para darle más información al gráfico le añadimos etiquetas y títulos que sean más informativas que los nombres de variables.</span>
<span id="cb189-627"><a href="#cb189-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-628"><a href="#cb189-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo títulos}</span></span>
<span id="cb189-629"><a href="#cb189-629" aria-hidden="true" tabindex="-1"></a><span class="co">#démosle más información a la gráfica de dispersión.</span></span>
<span id="cb189-630"><a href="#cb189-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-631"><a href="#cb189-631" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">labs</span>(</span>
<span id="cb189-632"><a href="#cb189-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Población (en millones)"</span>,   <span class="co"># Cambia el nombre del eje x</span></span>
<span id="cb189-633"><a href="#cb189-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Homicidios con arma de fuego"</span>,            <span class="co"># Cambia el nombre del eje y</span></span>
<span id="cb189-634"><a href="#cb189-634" aria-hidden="true" tabindex="-1"></a>  <span class="at">colour =</span> <span class="st">"Región"</span>,              <span class="co"># Cambia el nombre de la leyenda de color</span></span>
<span id="cb189-635"><a href="#cb189-635" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Homicidios con arma de fuego en EEUU, 2010"</span>  <span class="co"># Título del gráfico</span></span>
<span id="cb189-636"><a href="#cb189-636" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb189-637"><a href="#cb189-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-638"><a href="#cb189-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-639"><a href="#cb189-639" aria-hidden="true" tabindex="-1"></a>Hasta ahora hemos ido añadiendo capas pero notamos que tenemos una gran concentración de puntos en la parte inferior izquierda del lienzo: la mayoría de las jurisdicciones tienen menos de 10 millones de habitantes y menos de 400 homicidios. Esto hace leer e interpretar lo que sucede en para estos casos difícil. Podríamos entonces representar el gráfico con una transformación logarítmica al re-escalar con <span class="in">`scale_x_continuous`</span> y <span class="in">`scale_y_continuous`</span>:</span>
<span id="cb189-640"><a href="#cb189-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-641"><a href="#cb189-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Haciendo una transformación de escala}</span></span>
<span id="cb189-642"><a href="#cb189-642" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb189-643"><a href="#cb189-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb189-644"><a href="#cb189-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">colour =</span> region), <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb189-645"><a href="#cb189-645" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">y =</span> total, <span class="at">label =</span> abb),<span class="at">nudge_x =</span> <span class="fl">0.05</span>)</span>
<span id="cb189-646"><a href="#cb189-646" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>p2<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>)<span class="sc">+</span></span>
<span id="cb189-647"><a href="#cb189-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">transform =</span> <span class="st">"log10"</span>)</span>
<span id="cb189-648"><a href="#cb189-648" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>p2<span class="sc">+</span></span>
<span id="cb189-649"><a href="#cb189-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb189-650"><a href="#cb189-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Población (millones, escala log.)"</span>,   <span class="co"># Cambia el nombre del eje x</span></span>
<span id="cb189-651"><a href="#cb189-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Homicidios por arma de fuego (escala log.)"</span>,            <span class="co"># Cambia el nombre del eje y</span></span>
<span id="cb189-652"><a href="#cb189-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Región"</span>,              <span class="co"># Cambia el nombre de la leyenda de color</span></span>
<span id="cb189-653"><a href="#cb189-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Homicidios por arma de fuego vs población, por región"</span>  <span class="co"># Título del gráfico</span></span>
<span id="cb189-654"><a href="#cb189-654" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb189-655"><a href="#cb189-655" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb189-656"><a href="#cb189-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-657"><a href="#cb189-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-658"><a href="#cb189-658" aria-hidden="true" tabindex="-1"></a>Podríamos añadir una capa temática, usando el paquete <span class="in">`ggthemes`</span>, que tiene un catálogo estético variado, que recomiendo verifiquen a través de <span class="ot">&lt;https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/&gt;</span>. Esto es en adición a los que ya ofrece el paquete de <span class="in">`ggplot2`</span> <span class="ot">&lt;https://ggplot2.tidyverse.org/reference/ggtheme.html&gt;</span>.</span>
<span id="cb189-659"><a href="#cb189-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-660"><a href="#cb189-660" aria-hidden="true" tabindex="-1"></a>En este caso le añadiré una visualización al estilo del semanario británico *The Economist.*</span>
<span id="cb189-661"><a href="#cb189-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-662"><a href="#cb189-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo temas}</span></span>
<span id="cb189-663"><a href="#cb189-663" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb189-664"><a href="#cb189-664" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">theme_economist</span>()</span>
<span id="cb189-665"><a href="#cb189-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-666"><a href="#cb189-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-667"><a href="#cb189-667" aria-hidden="true" tabindex="-1"></a><span class="fu">## El gráfico que buscábamos</span></span>
<span id="cb189-668"><a href="#cb189-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-669"><a href="#cb189-669" aria-hidden="true" tabindex="-1"></a>Normalmente queremos añadir formas o anotaciones a las figuras que no se derivan directamente del mapeo estético; algunos ejemplos incluyen etiquetas, cuadros, áreas sombreadas y líneas. Si queremos añadir una línea que represente la tasa promedio de asesinatos en todos los Estados Unidos, tendremos que determinarlo aparte con la ayuda de <span class="in">`dplyr`</span> (parte de <span class="in">`tidyverse`</span>), y tendremos que hacer la transformación adecuada también (logarítmica):</span>
<span id="cb189-670"><a href="#cb189-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-671"><a href="#cb189-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r el gráfico que buscábamos (datos de asesinatos)}</span></span>
<span id="cb189-672"><a href="#cb189-672" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb189-673"><a href="#cb189-673" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb189-674"><a href="#cb189-674" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb189-675"><a href="#cb189-675" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> murders <span class="sc">|&gt;</span> </span>
<span id="cb189-676"><a href="#cb189-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa =</span> <span class="fu">sum</span>(total) <span class="sc">/</span>  <span class="fu">sum</span>(population) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb189-677"><a href="#cb189-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(tasa)</span>
<span id="cb189-678"><a href="#cb189-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-679"><a href="#cb189-679" aria-hidden="true" tabindex="-1"></a>murders <span class="sc">|&gt;</span> </span>
<span id="cb189-680"><a href="#cb189-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(región<span class="ot">=</span><span class="fu">case_when</span>(</span>
<span id="cb189-681"><a href="#cb189-681" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Northeast"</span> <span class="sc">~</span> <span class="st">"Noreste"</span>,</span>
<span id="cb189-682"><a href="#cb189-682" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"North Central"</span> <span class="sc">~</span> <span class="st">"el Midwest"</span>,</span>
<span id="cb189-683"><a href="#cb189-683" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"West"</span> <span class="sc">~</span> <span class="st">"Oeste"</span>,</span>
<span id="cb189-684"><a href="#cb189-684" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>))<span class="sc">|&gt;</span></span>
<span id="cb189-685"><a href="#cb189-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(population<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, total)) <span class="sc">+</span>   </span>
<span id="cb189-686"><a href="#cb189-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">log10</span>(t), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) <span class="sc">+</span></span>
<span id="cb189-687"><a href="#cb189-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> región), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb189-688"><a href="#cb189-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> abb)) <span class="sc">+</span> </span>
<span id="cb189-689"><a href="#cb189-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb189-690"><a href="#cb189-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb189-691"><a href="#cb189-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Homicidios en EEUU con arma de fuego en 2010"</span>,</span>
<span id="cb189-692"><a href="#cb189-692" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Población (en millones, escala log.)"</span>, </span>
<span id="cb189-693"><a href="#cb189-693" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Homicidios por arma de fuego (en escala log.)"</span>,</span>
<span id="cb189-694"><a href="#cb189-694" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Región"</span>) <span class="sc">+</span></span>
<span id="cb189-695"><a href="#cb189-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb189-696"><a href="#cb189-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-697"><a href="#cb189-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-698"><a href="#cb189-698" aria-hidden="true" tabindex="-1"></a>He aquí los pasos entonces que necesitábamos para recrear la imagen arriba.'</span>
<span id="cb189-699"><a href="#cb189-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-700"><a href="#cb189-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gráficos rápidos: `qplot()`</span></span>
<span id="cb189-701"><a href="#cb189-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-702"><a href="#cb189-702" aria-hidden="true" tabindex="-1"></a>Si bien esto ha sido útil y han podido ver cómo generar gráficas complejas siguiendo la gramática de gráficos, es probable que en algún momento quieran ver rápidamente unas relaciones visuales de manera instantánea, con la intención luego de volver y darle mejor forma y seguir las complicaciones de un gráfico de <span class="in">`ggplot2`</span> con todas sus capas. La opción que da <span class="in">`ggplot2`</span> a esto es el uso de <span class="in">`qplot()`</span>.</span>
<span id="cb189-703"><a href="#cb189-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-704"><a href="#cb189-704" aria-hidden="true" tabindex="-1"></a>Por ejemplo, aquí modifiqué los grupos de jurisdicciones de Estados Unidos a unos grupos específicos, y creo un gráfico para ver densidades con relleno (<span class="in">`fill=grupo`</span>) y con líneas que también sirven para demarcar estos grupos de manera distinta (e.g. línea sólida, línea entrecortada). Noten que ha corrido todo el gráfico de la última línea.</span>
<span id="cb189-705"><a href="#cb189-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-706"><a href="#cb189-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Un qplot inicial}</span></span>
<span id="cb189-707"><a href="#cb189-707" aria-hidden="true" tabindex="-1"></a>murdersg<span class="ot">&lt;-</span>murders <span class="sc">|&gt;</span></span>
<span id="cb189-708"><a href="#cb189-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasa=</span> total<span class="sc">/</span>population <span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>,</span>
<span id="cb189-709"><a href="#cb189-709" aria-hidden="true" tabindex="-1"></a>    ,<span class="at">grupo =</span> <span class="fu">case_when</span>(</span>
<span id="cb189-710"><a href="#cb189-710" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ME"</span>, <span class="st">"NH"</span>, <span class="st">"VT"</span>, <span class="st">"MA"</span>, <span class="st">"RI"</span>, <span class="st">"CT"</span>) <span class="sc">~</span> <span class="st">"Nueva Inglaterra"</span>,</span>
<span id="cb189-711"><a href="#cb189-711" aria-hidden="true" tabindex="-1"></a>    abb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span>) <span class="sc">~</span> <span class="st">"Costa del Pacífico"</span>,</span>
<span id="cb189-712"><a href="#cb189-712" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"South"</span> <span class="sc">~</span> <span class="st">"el Sur"</span>,</span>
<span id="cb189-713"><a href="#cb189-713" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otras regiones"</span>))</span>
<span id="cb189-714"><a href="#cb189-714" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(tasa, <span class="at">data =</span> murdersg, <span class="at">geom=</span> <span class="st">"density"</span>, <span class="at">fill =</span> grupo, <span class="at">linetype=</span>grupo)</span>
<span id="cb189-715"><a href="#cb189-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-716"><a href="#cb189-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-717"><a href="#cb189-717" aria-hidden="true" tabindex="-1"></a>En las siguientes líneas pido y ejecuto variaciones de gráficos con qplot con los datos de altura del libro de Irizarry:</span>
<span id="cb189-718"><a href="#cb189-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-719"><a href="#cb189-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Varios qplots}</span></span>
<span id="cb189-720"><a href="#cb189-720" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heights)            </span>
<span id="cb189-721"><a href="#cb189-721" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>heights<span class="sc">|&gt;</span><span class="fu">ggplot</span>()</span>
<span id="cb189-722"><a href="#cb189-722" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom=</span> <span class="st">"boxplot"</span>, <span class="at">fill =</span> sex)</span>
<span id="cb189-723"><a href="#cb189-723" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom=</span> <span class="st">"violin"</span>, <span class="at">fill =</span> sex)</span>
<span id="cb189-724"><a href="#cb189-724" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sex, height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"dotplot"</span>,</span>
<span id="cb189-725"><a href="#cb189-725" aria-hidden="true" tabindex="-1"></a>      <span class="at">stackdir =</span> <span class="st">"center"</span>, <span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">dotsize =</span> <span class="fl">0.3</span>)</span>
<span id="cb189-726"><a href="#cb189-726" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"density"</span>, <span class="at">fill =</span> sex)</span>
<span id="cb189-727"><a href="#cb189-727" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(height, <span class="at">data =</span> heights, <span class="at">geom =</span> <span class="st">"density"</span>, <span class="at">color =</span> sex, <span class="at">linetype =</span> sex)</span>
<span id="cb189-728"><a href="#cb189-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-729"><a href="#cb189-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-730"><a href="#cb189-730" aria-hidden="true" tabindex="-1"></a>Nuevamente podríamos mostrar información adicional, como medias añadidas fuera de las estéticas definidas dentro del mapeo:</span>
<span id="cb189-731"><a href="#cb189-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-732"><a href="#cb189-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Dando a densidades transparencias}</span></span>
<span id="cb189-733"><a href="#cb189-733" aria-hidden="true" tabindex="-1"></a>mu_alt<span class="ot">&lt;-</span>heights <span class="sc">|&gt;</span></span>
<span id="cb189-734"><a href="#cb189-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb189-735"><a href="#cb189-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media=</span><span class="fu">mean</span>(height))</span>
<span id="cb189-736"><a href="#cb189-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-737"><a href="#cb189-737" aria-hidden="true" tabindex="-1"></a>c<span class="ot">&lt;-</span>heights<span class="sc">|&gt;</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height))</span>
<span id="cb189-738"><a href="#cb189-738" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span><span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sex), <span class="at">alpha=</span><span class="fl">0.4</span>) <span class="co">#el alpha le da un nivel de transparencia </span></span>
<span id="cb189-739"><a href="#cb189-739" aria-hidden="true" tabindex="-1"></a><span class="co">#¿qué creen que pase si suben el valor a 0.9 o lo reducen a 0.1?</span></span>
<span id="cb189-740"><a href="#cb189-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-741"><a href="#cb189-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-742"><a href="#cb189-742" aria-hidden="true" tabindex="-1"></a>Noten que si tenemos dos categorías, al pedir color, tiende a establecer a uno con un rojo magenta y al segundo con un azul cian (aciano o ciano), en este caso suavizado y transparentado para poder ver las distribuciones. Sin embargo, podemos editar el color manualmente, a la vez que añadimos complicaciones como una media de alturas por grupo.</span>
<span id="cb189-743"><a href="#cb189-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-744"><a href="#cb189-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Añadiendo color manualmente}</span></span>
<span id="cb189-745"><a href="#cb189-745" aria-hidden="true" tabindex="-1"></a>c<span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb189-746"><a href="#cb189-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu_alt, <span class="fu">aes</span>(<span class="at">xintercept=</span>media, <span class="at">color=</span>sex),</span>
<span id="cb189-747"><a href="#cb189-747" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb189-748"><a href="#cb189-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>)) <span class="co">#noten que aquí le di los colores con código alfanumérico, un gris plateado y un dorado.</span></span>
<span id="cb189-749"><a href="#cb189-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-750"><a href="#cb189-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-751"><a href="#cb189-751" aria-hidden="true" tabindex="-1"></a>Hay varios métodos para asignar colores al nombrarlos en R. Se puede hacer por nombre (en inglés), con códigos alfanúmericos, y se puede también importar paletas de colores con paquetes específicos. Considero útil revisar las opciones en este enlace: <span class="ot">&lt;https://r-graph-gallery.com/ggplot2-color.html&gt;</span></span>
<span id="cb189-752"><a href="#cb189-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-753"><a href="#cb189-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alcanzando visualización de densidades y sus cambios a través del tiempo</span></span>
<span id="cb189-754"><a href="#cb189-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-757"><a href="#cb189-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-758"><a href="#cb189-758" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb189-759"><a href="#cb189-759" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder)</span>
<span id="cb189-760"><a href="#cb189-760" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb189-761"><a href="#cb189-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-762"><a href="#cb189-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-763"><a href="#cb189-763" aria-hidden="true" tabindex="-1"></a>Vemos que estos datos incluyen una variedad de información a nivel de país, que incluye un número de años para ellos.</span>
<span id="cb189-764"><a href="#cb189-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-765"><a href="#cb189-765" aria-hidden="true" tabindex="-1"></a>Podemos ver los grupos de países por continentes usando una matriz de gráficos, con cuadrículas paradas y acostadas:</span>
<span id="cb189-766"><a href="#cb189-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-769"><a href="#cb189-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb189-770"><a href="#cb189-770" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb189-771"><a href="#cb189-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb189-772"><a href="#cb189-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-773"><a href="#cb189-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(continent<span class="sc">~</span>year)</span>
<span id="cb189-774"><a href="#cb189-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-775"><a href="#cb189-775" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb189-776"><a href="#cb189-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">col =</span> continent)) <span class="sc">+</span></span>
<span id="cb189-777"><a href="#cb189-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-778"><a href="#cb189-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span>
<span id="cb189-779"><a href="#cb189-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-780"><a href="#cb189-780" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2012</span>,<span class="dv">2015</span>)</span>
<span id="cb189-781"><a href="#cb189-781" aria-hidden="true" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Europe"</span>, <span class="st">"Asia"</span>)</span>
<span id="cb189-782"><a href="#cb189-782" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-783"><a href="#cb189-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> continent <span class="sc">%in%</span> continents) <span class="sc">|&gt;</span></span>
<span id="cb189-784"><a href="#cb189-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(fertility, life_expectancy, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb189-785"><a href="#cb189-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-786"><a href="#cb189-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Fertilidad"</span>, <span class="at">y=</span><span class="st">"Esperanza de vida"</span>,<span class="at">colour=</span><span class="st">"Continente"</span>)</span>
<span id="cb189-787"><a href="#cb189-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-788"><a href="#cb189-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-789"><a href="#cb189-789" aria-hidden="true" tabindex="-1"></a>En este caso podemos apreciar mejor cómo la dispersión y distribución de países entre los años 1960s y el presente reciente ha ido encaminado a una convergencia en estándares de vida, dejando atrás los puntos donde originaron estereotipos que aún persisten sobre cómo son las vidas y experiencias de distintas regiones del planeta (sin desestimar diferencias e inequidades presentes).</span>
<span id="cb189-790"><a href="#cb189-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-791"><a href="#cb189-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Creando visualización sobre ingresos diarios}</span></span>
<span id="cb189-792"><a href="#cb189-792" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> <span class="fu">mutate</span>(dólares<span class="at">_diarios =</span> gdp<span class="sc">/</span>population<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb189-793"><a href="#cb189-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-794"><a href="#cb189-794" aria-hidden="true" tabindex="-1"></a>antaño <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb189-795"><a href="#cb189-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-796"><a href="#cb189-796" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-797"><a href="#cb189-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb189-798"><a href="#cb189-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">reorder</span>(region, dólares_diarios, <span class="at">FUN =</span> median)) <span class="sc">|&gt;</span></span>
<span id="cb189-799"><a href="#cb189-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, region)) <span class="sc">+</span></span>
<span id="cb189-800"><a href="#cb189-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-801"><a href="#cb189-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span>
<span id="cb189-802"><a href="#cb189-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-803"><a href="#cb189-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-804"><a href="#cb189-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Creando categorías para ver mejor dinámicas}</span></span>
<span id="cb189-805"><a href="#cb189-805" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-806"><a href="#cb189-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupo =</span> <span class="fu">case_when</span>(</span>
<span id="cb189-807"><a href="#cb189-807" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Western Europe"</span>, <span class="st">"Northern Europe"</span>,<span class="st">"Southern Europe"</span>,</span>
<span id="cb189-808"><a href="#cb189-808" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Northern America"</span>,</span>
<span id="cb189-809"><a href="#cb189-809" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Australia and New Zealand"</span>) <span class="sc">~</span> <span class="st">"Occidente"</span>,</span>
<span id="cb189-810"><a href="#cb189-810" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Eastern Asia"</span>, <span class="st">"South-Eastern Asia"</span>) <span class="sc">~</span> <span class="st">"Asia oriental"</span>,</span>
<span id="cb189-811"><a href="#cb189-811" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Caribbean"</span>, <span class="st">"Central America"</span>,</span>
<span id="cb189-812"><a href="#cb189-812" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"South America"</span>) <span class="sc">~</span> <span class="st">"Latinoamérica"</span>,</span>
<span id="cb189-813"><a href="#cb189-813" aria-hidden="true" tabindex="-1"></a>    continent <span class="sc">==</span> <span class="st">"Africa"</span> <span class="sc">&amp;</span></span>
<span id="cb189-814"><a href="#cb189-814" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">!=</span> <span class="st">"Northern Africa"</span> <span class="sc">~</span> <span class="st">"África subsahariana"</span>,</span>
<span id="cb189-815"><a href="#cb189-815" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otros"</span>))</span>
<span id="cb189-816"><a href="#cb189-816" aria-hidden="true" tabindex="-1"></a><span class="co">#le damos orden a los niveles</span></span>
<span id="cb189-817"><a href="#cb189-817" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-818"><a href="#cb189-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupo =</span> <span class="fu">factor</span>(grupo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Otros"</span>, <span class="st">"Latinoamérica"</span>,</span>
<span id="cb189-819"><a href="#cb189-819" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Asia oriental"</span>, <span class="st">"África subsahariana"</span>,</span>
<span id="cb189-820"><a href="#cb189-820" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Occidente"</span>)))</span>
<span id="cb189-821"><a href="#cb189-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-822"><a href="#cb189-822" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-823"><a href="#cb189-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb189-824"><a href="#cb189-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(grupo, dólares_diarios)) <span class="sc">+</span></span>
<span id="cb189-825"><a href="#cb189-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb189-826"><a href="#cb189-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb189-827"><a href="#cb189-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb189-828"><a href="#cb189-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb189-829"><a href="#cb189-829" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb189-830"><a href="#cb189-830" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="co">#añadiendo puntos para ver mejor distribuciones y cantidad de casos</span></span>
<span id="cb189-831"><a href="#cb189-831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-832"><a href="#cb189-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-833"><a href="#cb189-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Densidades}</span></span>
<span id="cb189-834"><a href="#cb189-834" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb189-835"><a href="#cb189-835" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-836"><a href="#cb189-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb189-837"><a href="#cb189-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, grupo)) <span class="sc">+</span></span>
<span id="cb189-838"><a href="#cb189-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span>
<span id="cb189-839"><a href="#cb189-839" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density_ridges</span>()</span>
<span id="cb189-840"><a href="#cb189-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-841"><a href="#cb189-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-842"><a href="#cb189-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Densidades con información de observaciones}</span></span>
<span id="cb189-843"><a href="#cb189-843" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density_ridges</span>(<span class="at">jittered_points =</span> <span class="cn">TRUE</span>,</span>
<span id="cb189-844"><a href="#cb189-844" aria-hidden="true" tabindex="-1"></a>                        <span class="at">position =</span> <span class="fu">position_points_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb189-845"><a href="#cb189-845" aria-hidden="true" tabindex="-1"></a>                        <span class="at">point_shape =</span> <span class="st">'|'</span>, <span class="at">point_size =</span> <span class="dv">3</span>,</span>
<span id="cb189-846"><a href="#cb189-846" aria-hidden="true" tabindex="-1"></a>                        <span class="at">point_alpha =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) </span>
<span id="cb189-847"><a href="#cb189-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-848"><a href="#cb189-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-849"><a href="#cb189-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Histogramas comparativos en facetas}</span></span>
<span id="cb189-850"><a href="#cb189-850" aria-hidden="true" tabindex="-1"></a>antaño <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb189-851"><a href="#cb189-851" aria-hidden="true" tabindex="-1"></a>año_presente <span class="ot">&lt;-</span> <span class="dv">2010</span></span>
<span id="cb189-852"><a href="#cb189-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-853"><a href="#cb189-853" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(antaño, año_presente)</span>
<span id="cb189-854"><a href="#cb189-854" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-855"><a href="#cb189-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb189-856"><a href="#cb189-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">west =</span> <span class="fu">ifelse</span>(grupo <span class="sc">==</span> <span class="st">"Occidente"</span>, <span class="st">"Occidente"</span>, <span class="st">"El Resto"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb189-857"><a href="#cb189-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios)) <span class="sc">+</span></span>
<span id="cb189-858"><a href="#cb189-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb189-859"><a href="#cb189-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb189-860"><a href="#cb189-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> west)</span>
<span id="cb189-861"><a href="#cb189-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-862"><a href="#cb189-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-863"><a href="#cb189-863" aria-hidden="true" tabindex="-1"></a>Sabemos que muchos países surgieron después de 1970 (razón por la cual el histograma se nutre para el grupo **El Resto**), así que para comparar los países que tienen toda la información y han existido consistentemente entre esos periodos y ver si hay cambios y de dónde surgen en distribuciones podemos hacer lo siguiente:</span>
<span id="cb189-864"><a href="#cb189-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-865"><a href="#cb189-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Wrangling para comparar chinas con chinas}</span></span>
<span id="cb189-866"><a href="#cb189-866" aria-hidden="true" tabindex="-1"></a>country_list_1 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-867"><a href="#cb189-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> antaño <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb189-868"><a href="#cb189-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb189-869"><a href="#cb189-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-870"><a href="#cb189-870" aria-hidden="true" tabindex="-1"></a>country_list_2 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-871"><a href="#cb189-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> año_presente <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb189-872"><a href="#cb189-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb189-873"><a href="#cb189-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-874"><a href="#cb189-874" aria-hidden="true" tabindex="-1"></a>country_list <span class="ot">&lt;-</span> <span class="fu">intersect</span>(country_list_1, country_list_2)</span>
<span id="cb189-875"><a href="#cb189-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-876"><a href="#cb189-876" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-877"><a href="#cb189-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb189-878"><a href="#cb189-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(grupo, dólares_diarios)) <span class="sc">+</span></span>
<span id="cb189-879"><a href="#cb189-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb189-880"><a href="#cb189-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb189-881"><a href="#cb189-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb189-882"><a href="#cb189-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb189-883"><a href="#cb189-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span>
<span id="cb189-884"><a href="#cb189-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-885"><a href="#cb189-885" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-886"><a href="#cb189-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dólares_diarios)) <span class="sc">|&gt;</span></span>
<span id="cb189-887"><a href="#cb189-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, grupo)) <span class="sc">+</span></span>
<span id="cb189-888"><a href="#cb189-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>) <span class="sc">+</span></span>
<span id="cb189-889"><a href="#cb189-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">adjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb189-890"><a href="#cb189-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> year)</span>
<span id="cb189-891"><a href="#cb189-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-892"><a href="#cb189-892" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb189-893"><a href="#cb189-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb189-894"><a href="#cb189-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb189-895"><a href="#cb189-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb189-896"><a href="#cb189-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb189-897"><a href="#cb189-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dólares_diarios, <span class="at">fill =</span> grupo)) <span class="sc">+</span></span>
<span id="cb189-898"><a href="#cb189-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb189-899"><a href="#cb189-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">bw =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb189-900"><a href="#cb189-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> .)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidades apiladas: ingreso en dólares por día per cápita entre 1970 y 2010"</span>,</span>
<span id="cb189-901"><a href="#cb189-901" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Dólares por día"</span>, </span>
<span id="cb189-902"><a href="#cb189-902" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb189-903"><a href="#cb189-903" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Regiones"</span>)</span>
<span id="cb189-904"><a href="#cb189-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-905"><a href="#cb189-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb189-906"><a href="#cb189-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-907"><a href="#cb189-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-908"><a href="#cb189-908" aria-hidden="true" tabindex="-1"></a><span class="fu"># Recapitulando</span></span>
<span id="cb189-909"><a href="#cb189-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-910"><a href="#cb189-910" aria-hidden="true" tabindex="-1"></a><span class="fu">## Qué aprendimos en este taller inicial</span></span>
<span id="cb189-911"><a href="#cb189-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-912"><a href="#cb189-912" aria-hidden="true" tabindex="-1"></a>Hoy aprendimos varias cosas para empezar a usar R:</span>
<span id="cb189-913"><a href="#cb189-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-914"><a href="#cb189-914" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Hablamos sobre cómo descargar e instalar R y RStudio;</span>
<span id="cb189-915"><a href="#cb189-915" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Funcionalidades posibles, como Markdown;</span>
<span id="cb189-916"><a href="#cb189-916" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Funciones y jerga específica de R;</span>
<span id="cb189-917"><a href="#cb189-917" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cómo cargar datos y visualizarlos;</span>
<span id="cb189-918"><a href="#cb189-918" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cómo buscar estadísticas básicas;</span>
<span id="cb189-919"><a href="#cb189-919" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cómo llevar a cabo operaciones transformadoras a los datos;</span>
<span id="cb189-920"><a href="#cb189-920" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Empezamos a usar la sintaxis de tidyverse.</span>
<span id="cb189-921"><a href="#cb189-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-922"><a href="#cb189-922" aria-hidden="true" tabindex="-1"></a><span class="fu">## Continuamos el próximo martes</span></span>
<span id="cb189-923"><a href="#cb189-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-924"><a href="#cb189-924" aria-hidden="true" tabindex="-1"></a>En el siguiente taller talleres que vienen continuaremos ahondando en operaciones estadísticas, visualización más avanzada, estadística inferencial y análisis de redes. Gracias por asistir hoy.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>